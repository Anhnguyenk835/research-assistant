sections,tables,figures,raw_text,page_info,parser_type,metadata
"[{'label': 'section_header', 'content': 'Financial Report Chunking for E ff ective Retrieval Augmented Generation', 'prov': [{'page_no': 1, 'bbox': {'l': 165.6, 't': 675.163, 'r': 449.497, 'b': 645.678, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 72.0]}], 'level': 1}, {'label': 'text', 'content': 'Antonio Jimeno Yepes, Yao You, Jan Milczek, Sebastian Laverde, and Renyu Li', 'prov': [{'page_no': 1, 'bbox': {'l': 134.76, 't': 619.955, 'r': 480.594, 'b': 611.108, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 75.0]}], 'level': None}, {'label': 'text', 'content': 'Unstructured Technologies Sacramento, CA, USA leah@unstructured.io https://unstructured.io', 'prov': [{'page_no': 1, 'bbox': {'l': 253.56, 't': 598.412, 'r': 361.838, 'b': 557.746, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 90.0]}], 'level': None}, {'label': 'text', 'content': 'Abstract. Chunking information is a key step in Retrieval Augmented Generation (RAG). Current research primarily centers on paragraphlevel chunking. This approach treats all texts as equal and neglects the information contained in the structure of documents. We propose an expanded approach to chunk documents by moving beyond mere paragraph-level chunking to chunk primary by structural element components of documents. Dissecting documents into these constituent elements creates a new way to chunk documents that yields the best chunk size without tuning. We introduce a novel framework that evaluates how chunking based on element types annotated by document understanding models contributes to the overall context and accuracy of the information retrieved. We also demonstrate how this approach impacts RAG assisted Question & Answer task performance. Our research includes a comprehensive analysis of various element types, their role in e ff ective information retrieval, and the impact they have on the quality of RAG outputs. Findings support that element type based chunking largely improve RAG results on financial reporting. Through this research, we are also able to answer how to uncover highly accurate RAG.', 'prov': [{'page_no': 1, 'bbox': {'l': 163.08, 't': 522.452, 'r': 452.345, 'b': 328.13, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 1222.0]}], 'level': None}, {'label': 'text', 'content': 'Keywords: Retrieval Augmented Generation · Document Chunking · Document Pre-Processing · Financial Domain · Large Language Models', 'prov': [{'page_no': 1, 'bbox': {'l': 163.08, 't': 313.901, 'r': 452.195, 'b': 295.01, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 129.0]}], 'level': None}, {'label': 'section_header', 'content': '1 Introduction', 'prov': [{'page_no': 1, 'bbox': {'l': 134.76, 't': 269.51700000000005, 'r': 228.986, 'b': 259.946, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 14.0]}], 'level': 1}, {'label': 'text', 'content': 'Existing approaches for document understanding use a combination of methods from the computer vision and natural language processing domains to identify the di ff erent components in a document. In the rapidly evolving landscape of artificial intelligence, the capability to e ff ectively process unstructured data is becoming increasingly critical. Large Language Models (LLMs) like GPT-4 have revolutionized natural language understanding and generation, as evidenced by their prompt-based functionalities [31], enabling a wide range of applications [5]. However, the e ffi cacy of these models is often constrained by their reliance on the size and quality of the data they process. A notable limitation is the restricted contextual window of LLMs, which hampers their ability to fully comprehend the', 'prov': [{'page_no': 1, 'bbox': {'l': 134.76, 't': 243.27600000000007, 'r': 480.729, 'b': 126.90899999999999, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 803.0]}], 'level': None}, {'label': 'text', 'content': 'contents of extensive documents [25,22,18]. By dissecting large volumes of text into smaller, more focused segments, LLMs can process each part with greater precision, ensuring a thorough understanding of each section. This segmented approach allows for meticulous analysis of unstructured data, enabling LLMs to construct a more comprehensive and coherent understanding of the entire document [41]. There remains a challenge in ensuring factual accuracy and relevance in the generated responses, especially when dealing with complex or extensive information.', 'prov': [{'page_no': 2, 'bbox': {'l': 134.76, 't': 672.875, 'r': 480.777, 'b': 580.268, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 559.0]}], 'level': None}, {'label': 'text', 'content': 'Recently, Retrieval Augmented Generation (RAG) [21,12] has been developed to address the hallucination problem with LLMs [15,43] when recovering factual information directly from an LLM. In RAG, instead of answering a user query directly using an LLM, the user query is used to retrieve documents or segments from a corpus and the top retrieved documents or segments are used to generate the answer in conjunction with an LLM. In this way, RAG constraints the answer to the set of retrieved documents. RAGs have been used as well to answer questions from single documents [14]. The documents are split into smaller parts or chunks, indexed by a retrieval system and recovered and processed depending on the user information need. In a sense, this process allows answering questions about information in a single document, thus contributing to the set of techniques available for document understanding.', 'prov': [{'page_no': 2, 'bbox': {'l': 134.76, 't': 576.515, 'r': 480.901, 'b': 436.148, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 902.0]}], 'level': None}, {'label': 'text', 'content': 'Since documents need to be chunked for RAG processing, this raises the question about what is the best practice to chunk documents for e ff ective RAG document understanding. There are several dimensions to consider when deciding how to chunk a document, which includes the size of the chunks.', 'prov': [{'page_no': 2, 'bbox': {'l': 134.76, 't': 432.395, 'r': 480.611, 'b': 387.668, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 293.0]}], 'level': None}, {'label': 'text', 'content': 'The retrieval system in RAG can use traditional retrieval systems using bagof-words methods or a vector database. If a vector database is used, then an embedding needs to be obtained from each chunk, thus the number of tokens in the chunk is relevant since the neural networks processing the chunks might have constraints on the number of tokens. As well, di ff erent chunk sizes might have undesirable retrieval results. Since the most relevant retrieved chunks need to be processed by an LLM, the number of tokens in retrieved chunks might have an e ff ect in the generation of the answer [25]. As we see, chunking is required for RAG systems and there are several advantages and disadvantages when considering how to chunk a document.', 'prov': [{'page_no': 2, 'bbox': {'l': 134.76, 't': 383.915, 'r': 480.802, 'b': 267.428, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 737.0]}], 'level': None}, {'label': 'text', 'content': 'In this work, we study specifically the chunking of U.S. Securities and Exchange Commission (SEC) 1 Financial Reports 2 , including 10-Ks, 10-Qs, and 8-Ks. This study plays a critical role in o ff ering insights into the financial health and operational dynamics of public companies. These documents present unique challenges in terms of document processing and information extraction as they consist of varying sizes and layouts, and contain a variety of tabular information. Previous work has evaluated the processing of these reports with simple chunking strategies (e.g., tokens), but we believe that a more e ff ective use of these reports might be achieved by a better pre-processing of the documents', 'prov': [{'page_no': 2, 'bbox': {'l': 134.76, 't': 263.67499999999995, 'r': 480.678, 'b': 159.188, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 706.0]}], 'level': None}, {'label': 'footnote', 'content': '1 https://www.sec.gov', 'prov': [{'page_no': 2, 'bbox': {'l': 137.52, 't': 147.46699999999998, 'r': 234.151, 'b': 138.226, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 21.0]}], 'level': None}, {'label': 'footnote', 'content': '2 https://www.sec.gov/files/cf-frm.pdf', 'prov': [{'page_no': 2, 'bbox': {'l': 137.52, 't': 136.42700000000002, 'r': 314.669, 'b': 127.30500000000006, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 38.0]}], 'level': None}, {'label': 'text', 'content': 'and chunking configuration 3 [14]. To the best of our knowledge, this is the first systematic study on chunking for document understanding and more specifically for processing financial reports.', 'prov': [{'page_no': 3, 'bbox': {'l': 134.76, 't': 674.024, 'r': 480.627, 'b': 640.028, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 194.0]}], 'level': None}, {'label': 'section_header', 'content': '2 Related work', 'prov': [{'page_no': 3, 'bbox': {'l': 134.76, 't': 614.876, 'r': 233.418, 'b': 605.304, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 14.0]}], 'level': 1}, {'label': 'text', 'content': ""RAG is an innovative method that has emerged to enhance the performance of LLMs by incorporating external knowledge, thereby boosting their capabilities. This technique has undergone substantial research, examining various configurations and applications. Key research includes Gao et al.'s [12] detailed analysis of RAG configurations and their role in enhancing Natural Language Processing (NLP) tasks, reducing errors, and improving factual accuracy. Several context retrieval methods are proposed to dynamically retrieve documents to improve the coherence of generated outputs [1]. Other research introduced advancements in RAG, including reasoning chain storage and optimization strategies for retrieval, respectively, broadening the scope and e ffi ciency of RAG applications in LLMs [21]. More recent work has compared RAG vs LLM fine-tuning, and identified that applying both improves the performance of each individual method [2]."", 'prov': [{'page_no': 3, 'bbox': {'l': 134.76, 't': 587.195, 'r': 480.783, 'b': 446.828, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 939.0]}], 'level': None}, {'label': 'text', 'content': ""Chunking has been identified as the key factor in the success of RAG, improving the relevance of retrieved content by ensuring accurate embedding of text with minimal noise. Various strategies have been developed for text subdivision, each with its unique approach. They can be summarized as follows: the fixed size strategy divides text into uniform segments, but it often overlooks the underlying textual structure. In contrast, the recursive strategy iteratively subdivides text using separators like punctuation marks, allowing it to adapt more fluidly to the content. The contextual strategy takes this a step further by employing NLP techniques such as sentence segmentation to represent the meaning in context. Lastly, the hybrid strategy combines di ff erent approaches, o ff ering greater flexibility in handling diverse text types [34]. However, an area yet to be explored in RAG chunking based on element types (document structure), which involves analyzing the inherent structure of documents, such as headings, paragraphs, tables, to guide the chunking process. Although chunking by Markdown and LaTeX comes closer to addressing element types, it's not the same in nature as a dedicated approach that directly considers document structure and element types for chunking, which could potentially yield more contextually relevant chunks."", 'prov': [{'page_no': 3, 'bbox': {'l': 134.76, 't': 443.195, 'r': 480.845, 'b': 231.06799999999998, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 1348.0]}], 'level': None}, {'label': 'text', 'content': 'Exploring the structure of financial reports is an exceptional area for establishing optimal principles for chunking. The intricate nature of document structures and contents has resulted in most of the work processing financial reports focusing on the identification of structural elements. Among previous work, we find El-Haj et al. [10] and the FinTOC challenges [17,4,11] that have worked at the document structure level for UK and French financial reports. Ad-', 'prov': [{'page_no': 3, 'bbox': {'l': 134.76, 't': 227.43399999999997, 'r': 480.722, 'b': 158.707, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 465.0]}], 'level': None}, {'label': 'footnote', 'content': '3 https://www.cnbc.com/2023/12/19/gpt-and-other-ai-models-cant-analyzean-sec-filing-researchers-find.html', 'prov': [{'page_no': 3, 'bbox': {'l': 137.52, 't': 147.46699999999998, 'r': 472.338, 'b': 127.30600000000004, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 105.0]}], 'level': None}, {'label': 'text', 'content': 'ditionally, there is recent work that considers U.S. SEC reports, which includes DocLayNet [33] and more specifically with the report tables in FinTabNet [45].', 'prov': [{'page_no': 4, 'bbox': {'l': 134.76, 't': 672.875, 'r': 480.566, 'b': 652.028, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 159.0]}], 'level': None}, {'label': 'text', 'content': 'On the side of financial models, there is work in sentiment analysis in finance [37], which includes the pre-training of specialised models such as FinBERT by Liu et al. [26], which is a BERT based model pre-trained on large corpora including large collections of financial news collected from di ff erent sites and FinBERT by DeSola et al, [9] trained on Wikipedia, BookCorpus and U.S. SEC data. Additional models include BloombergGPT [40], FinGPT [42] and Instruct-FinGPT[44].', 'prov': [{'page_no': 4, 'bbox': {'l': 134.76, 't': 648.875, 'r': 480.707, 'b': 568.388, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 478.0]}], 'level': None}, {'label': 'text', 'content': 'More advance datasets in the financial domain include FinQA [6], LLMWare [27], ConFIRM [8] and TAT-QA [46] among others [7,38,19] that have been prepared for retrieval and or Questions and Answering (Q&A) tasks over snippets of financial data that includes tabular data, which has allowed methods on large language models to be tested on them [39].', 'prov': [{'page_no': 4, 'bbox': {'l': 134.76, 't': 565.235, 'r': 494.28, 'b': 508.628, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 348.0]}], 'level': None}, {'label': 'text', 'content': 'Most of the previous work has focused on understanding the layout of financial documents or understanding specific snippets of existing reports with di ff erent levels of complexity, but there has not been much research in understanding financial report documents, except some more recent work that includes FinanceBench [14], in which a set of questions about the content of financial reports are proposed that includes the evidence snippet.', 'prov': [{'page_no': 4, 'bbox': {'l': 134.76, 't': 505.475, 'r': 480.678, 'b': 436.868, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 442.0]}], 'level': None}, {'label': 'text', 'content': 'More specifically on document chunking methods for RAG, there are standard approaches being considered such as chunking text into spans of a given token length (e.g. 128 and 256) or chunking based on sentences. Open source projects already allow simple processing of documents (e.g. Unstructured 4 , Llamaindex 5 or Langchain 6 ), without explicitly considering the table structure on which these chunking strategies are applied.', 'prov': [{'page_no': 4, 'bbox': {'l': 134.759, 't': 433.715, 'r': 480.73, 'b': 365.108, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 429.0]}], 'level': None}, {'label': 'text', 'content': 'Even though di ff erent approaches are available, an exhaustive evaluation of chunking applied to RAG and specifically to financial reporting, except for some limited chunking analysis [14,36], is non-existent. In our work, we compare a broad range of chunking approaches in addition to more simple ones and provide an analysis of the outcomes of di ff erent methods when asking questions about di ff erent aspects of the reports.', 'prov': [{'page_no': 4, 'bbox': {'l': 134.759, 't': 361.955, 'r': 480.703, 'b': 293.348, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 430.0]}], 'level': None}, {'label': 'section_header', 'content': '3 Methods', 'prov': [{'page_no': 4, 'bbox': {'l': 134.759, 't': 274.67599999999993, 'r': 206.301, 'b': 265.105, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 9.0]}], 'level': 1}, {'label': 'text', 'content': 'In this section, we present the chunking strategies that we have evaluated. Before describing the chunking strategies, we present the RAG environment in which these strategies have been evaluated and the dataset used for evaluation.', 'prov': [{'page_no': 4, 'bbox': {'l': 134.759, 't': 253.59500000000003, 'r': 480.703, 'b': 220.74800000000005, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 232.0]}], 'level': None}, {'label': 'section_header', 'content': '3.1 RAG setting for the experiments', 'prov': [{'page_no': 4, 'bbox': {'l': 134.759, 't': 202.91599999999994, 'r': 327.056, 'b': 194.90200000000004, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 35.0]}], 'level': 1}, {'label': 'text', 'content': 'The RAG pipeline used to process a user question is presented in figure 1 and is a common instance of a RAG [12]. Prior to answering any question about a given', 'prov': [{'page_no': 4, 'bbox': {'l': 134.759, 't': 186.995, 'r': 480.73, 'b': 166.14800000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 159.0]}], 'level': None}, {'label': 'footnote', 'content': '4 https://unstructured.io', 'prov': [{'page_no': 4, 'bbox': {'l': 137.52, 't': 158.38699999999994, 'r': 252.998, 'b': 149.14599999999996, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 25.0]}], 'level': None}, {'label': 'footnote', 'content': '5 https://www.llamaindex.ai', 'prov': [{'page_no': 4, 'bbox': {'l': 137.52, 't': 147.46699999999998, 'r': 262.359, 'b': 138.226, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 27.0]}], 'level': None}, {'label': 'footnote', 'content': '6 https://www.langchain.com', 'prov': [{'page_no': 4, 'bbox': {'l': 137.52, 't': 136.42700000000002, 'r': 262.359, 'b': 127.30500000000006, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 27.0]}], 'level': None}, {'label': 'text', 'content': 'document, the document is split into chunks and the chunks are indexed into a vector database (vectordb). When a question is sent to the RAG system, the top-k chunks most similar to the question are retrieved from the vector database and used to generate the answer using a large language model as generator. In order to retrieve chunks from the vector database, the question is encoded into a vector that is compared to the vector previously generated from the chunks. To prompt the generator, the question is converted into a set of instructions that instruct the LLM to find the answer within the top-k retrieved chunks.', 'prov': [{'page_no': 5, 'bbox': {'l': 134.76, 't': 672.875, 'r': 480.699, 'b': 580.268, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 623.0]}], 'level': None}, {'label': 'text', 'content': 'In our experiments, we modify the way documents are chunked prior to being indexed in the vector database. All other settings remain constant. In the following sections, we describe in more detail each one of the components and processes used.', 'prov': [{'page_no': 5, 'bbox': {'l': 134.759, 't': 433.475, 'r': 480.601, 'b': 388.748, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 243.0]}], 'level': None}, {'label': 'section_header', 'content': '3.2 Indexing and retrieval', 'prov': [{'page_no': 5, 'bbox': {'l': 134.759, 't': 365.637, 'r': 272.098, 'b': 357.622, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 26.0]}], 'level': 1}, {'label': 'text', 'content': 'We have used the open source system Weaviate 7 as our vector database. As encoder model, we have used a sentence transformer [35] trained on over 256M questions and answers, which is available from the HuggingFace system 8 .', 'prov': [{'page_no': 5, 'bbox': {'l': 134.759, 't': 345.584, 'r': 480.727, 'b': 311.708, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 224.0]}], 'level': None}, {'label': 'text', 'content': 'As shown in figure 2, to index a document, first the document is split into chunks, then each chunk is processed by an encoder model and then indexed into the vector database. Based on the chunking strategy a document will be split into a larger or smaller set of chunks.', 'prov': [{'page_no': 5, 'bbox': {'l': 134.759, 't': 308.195, 'r': 480.623, 'b': 263.4680000000001, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 271.0]}], 'level': None}, {'label': 'footnote', 'content': '7 https://weaviate.io/developers/weaviate', 'prov': [{'page_no': 5, 'bbox': {'l': 137.52, 't': 158.38699999999994, 'r': 328.127, 'b': 149.14599999999996, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 41.0]}], 'level': None}, {'label': 'footnote', 'content': '8 https://huggingface.co/sentence-transformers/multi-qa-mpnet-base-dotv1', 'prov': [{'page_no': 5, 'bbox': {'l': 137.52, 't': 147.46699999999998, 'r': 471.994, 'b': 127.30500000000006, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 72.0]}], 'level': None}, {'label': 'text', 'content': 'As shown in figure 1, to retrieve chunks relevant to a question, the question is converted into a vector representation and the vector database returns a ranked list of chunks based on the similarity between question vector and the chunks in the database. Weaviate implements an approximate nearest neighbours algorithm [28] as their retrieval approach, which supports fast retrieval with high accuracy. In our experiments, we retrieve the top-10 chunks for each question.', 'prov': [{'page_no': 6, 'bbox': {'l': 134.76, 't': 672.875, 'r': 480.799, 'b': 604.268, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 472.0]}], 'level': None}, {'label': 'section_header', 'content': '3.3 Generation', 'prov': [{'page_no': 6, 'bbox': {'l': 134.76, 't': 584.156, 'r': 216.836, 'b': 576.142, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 14.0]}], 'level': 1}, {'label': 'text', 'content': 'Once the vector database has retrieved the top-10 chunks based on a question, the generation module generates the answer. To do so, a prompt based on the question and the retrieved chunks are provided to a large language model that generates the answer of the system.', 'prov': [{'page_no': 6, 'bbox': {'l': 134.76, 't': 566.075, 'r': 480.627, 'b': 521.468, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 267.0]}], 'level': None}, {'label': 'text', 'content': 'We have used GPT-4 [31] as the generator, which has shown best performance compared to earlier versions. As well, its performance was better compared to existing open source alternatives [22] such as Mixtral [16]. We used the prompt presented in figure 3 that we designed on another similar RAG implementation with di ff erent document types. The prompt conditions the answer to the query and the chunks, referred to as source , and if the generator cannot answer it should return No answer .', 'prov': [{'page_no': 6, 'bbox': {'l': 134.759, 't': 518.315, 'r': 480.706, 'b': 437.708, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 492.0]}], 'level': None}, {'label': 'code', 'content': 'please answer the question below by referencing the list of sources provided after the question; if the question can not be answered just respond \'No answer\'. The sources are listed after ""Sources:"". Question: {query} Sources: {key} - {source} ...', 'prov': [{'page_no': 6, 'bbox': {'l': 145.08, 't': 412.803, 'r': 469.833, 'b': 328.785, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 247.0]}], 'level': None}, {'label': 'section_header', 'content': '3.4 Chunking', 'prov': [{'page_no': 6, 'bbox': {'l': 134.76, 't': 254.39699999999993, 'r': 209.241, 'b': 246.38200000000006, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 12.0]}], 'level': 1}, {'label': 'text', 'content': 'As a baseline chunking method, we have split the documents into chunks of size n tokens ( n ∈ ¶ 128 ↪ 256 ↪ 512 ♦ ). As well, an aggregation of the output by the indexing of di ff erent chunking configurations has been considered.', 'prov': [{'page_no': 6, 'bbox': {'l': 134.76, 't': 236.31500000000005, 'r': 480.583, 'b': 203.46799999999996, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 230.0]}], 'level': None}, {'label': 'text', 'content': 'In addition to chunking based on the number of tokens, we have processed the documents using computer vision and natural language processing to extract elements identified in the reports. The list of elements considered are provided by the Unstructured 9 open source library. From the set of processing strategies,', 'prov': [{'page_no': 6, 'bbox': {'l': 134.76, 't': 200.43499999999995, 'r': 480.746, 'b': 155.70799999999997, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 314.0]}], 'level': None}, {'label': 'footnote', 'content': '9 https://unstructured-io.github.io/unstructured/introduction.html# elements', 'prov': [{'page_no': 6, 'bbox': {'l': 137.52, 't': 147.46699999999998, 'r': 451.112, 'b': 127.30500000000006, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 76.0]}], 'level': None}, {'label': 'text', 'content': 'we use Chipper, a vision encoder decoder 10 model inspired by Donut [20] to showcase the performance di ff erence. The Chipper model outputs results as a JSON representation of the document, listing elements per page characterized by their element type. Additionally, Chipper provides a bounding box enclosing each element on the page and the corresponding element text.', 'prov': [{'page_no': 7, 'bbox': {'l': 134.76, 't': 674.024, 'r': 480.852, 'b': 616.148, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 370.0]}], 'level': None}, {'label': 'text', 'content': 'These elements are sometimes short to be considered as chunks, so to generate chunks from elements the following steps have been followed. Given the structure of finance reporting documents, our structural chunking e ff orts are concentrated on processing titles, texts, and tables. The steps to generate elementbased chunks are:', 'prov': [{'page_no': 7, 'bbox': {'l': 134.76, 't': 613.115, 'r': 480.679, 'b': 556.388, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 329.0]}], 'level': None}, {'label': 'list_item', 'content': '-if the element text length is smaller than 2,048 characters, a merge with the following element is attempted', 'prov': [{'page_no': 7, 'bbox': {'l': 141.0, 't': 544.475, 'r': 480.581, 'b': 523.628, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 109.0]}], 'level': None}, {'label': 'list_item', 'content': '-iteratively, element texts are merged following the step above till either the desired length is achieved, without breaking the element', 'prov': [{'page_no': 7, 'bbox': {'l': 141.0, 't': 520.715, 'r': 480.589, 'b': 499.868, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 136.0]}], 'level': None}, {'label': 'list_item', 'content': '-if a title element is found, a new chunk is started', 'prov': [{'page_no': 7, 'bbox': {'l': 141.0, 't': 496.955, 'r': 366.132, 'b': 488.108, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 52.0]}], 'level': None}, {'label': 'list_item', 'content': '-if a table element is found, a new chunk is started, preserving the entire table', 'prov': [{'page_no': 7, 'bbox': {'l': 141.0, 't': 485.195, 'r': 480.582, 'b': 476.348, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 81.0]}], 'level': None}, {'label': 'text', 'content': 'After element-based chunks have been derived, three types of metadata are generated to enrich the content and support e ffi cient indexing. The first two types, generated via predefined prompt templates with GPT-4, include: 1) up to 6 representative keywords of the composite chunk 2) a summarised paragraph of the composite chunk. The third type is 3) Naive representation using the first two sentences from a composite chunk (a kind of prefix) and in the case of tables, the description of the table, which is typically identified in the table caption.', 'prov': [{'page_no': 7, 'bbox': {'l': 134.76, 't': 464.195, 'r': 480.843, 'b': 383.708, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 554.0]}], 'level': None}, {'label': 'section_header', 'content': '3.5 Dataset', 'prov': [{'page_no': 7, 'bbox': {'l': 134.76, 't': 362.996, 'r': 199.455, 'b': 354.982, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 11.0]}], 'level': 1}, {'label': 'text', 'content': 'To evaluate the performance of the di ff erent chunking approaches, we have used the FinanceBench dataset [14]. FinanceBench is a new benchmarking dataset designed to assess the capabilities of LLMs in answering open-book financial questions. The questions collected are realistic and applicable to real-world financial scenarios and include complex questions that require computational reasoning to arrive at conclusive answers.', 'prov': [{'page_no': 7, 'bbox': {'l': 134.76, 't': 344.195, 'r': 480.782, 'b': 275.58799999999997, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 429.0]}], 'level': None}, {'label': 'text', 'content': 'This dataset is made of 150 instances with questions and answers from 84 unique reports. The dataset does not include the source documents, which we have downloaded. We were able to recover only 80 documents, which reduces the number of questions to 141 from the original 150. The distribution of Unstructured elements predictions are shown in table 1.', 'prov': [{'page_no': 7, 'bbox': {'l': 134.76, 't': 272.43499999999995, 'r': 480.689, 'b': 215.82799999999997, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 352.0]}], 'level': None}, {'label': 'text', 'content': 'Documents have a varying number of pages, spanning from 4 pages (FOOTLOCKER 2022 8K dated-2022-05-20) to 549 pages (e.g. PEPSICO 2021 10K), with an average of 147.34 with std 97.78 with a total of 11,787 pages combined. Each instance contains a link to the report, the question, a question type , the answer and supporting evidence, with page number where the evidence is located', 'prov': [{'page_no': 7, 'bbox': {'l': 134.76, 't': 212.67499999999995, 'r': 480.714, 'b': 156.06799999999998, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 379.0]}], 'level': None}, {'label': 'footnote', 'content': '10 https://huggingface.co/docs/transformers/model_doc/vision-encoderdecoder', 'prov': [{'page_no': 7, 'bbox': {'l': 133.8, 't': 147.46699999999998, 'r': 455.674, 'b': 127.30600000000004, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 75.0]}], 'level': None}, {'label': 'text', 'content': 'in the document, that allows for a closer evaluation of the results. Based on the page number, evidence contexts are located in di ff erent areas in the documents, ranging from the first page in some cases up to page 304 in one instance. The mean page number to find the evidence is 54.58 with a standard deviation of 43.66, which shows that evidence contexts to answer the questions are spread within a document. These characteristics make FinanceBench a perfect dataset for evaluating RAG. An example instance is available in table 2.', 'prov': [{'page_no': 8, 'bbox': {'l': 134.76, 't': 476.915, 'r': 480.76, 'b': 396.428, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 536.0]}], 'level': None}, {'label': 'section_header', 'content': '4 Results', 'prov': [{'page_no': 8, 'bbox': {'l': 134.76, 't': 371.636, 'r': 198.136, 'b': 362.065, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 9.0]}], 'level': 1}, {'label': 'text', 'content': 'In this section, we evaluate the di ff erent chunking strategies using the FinanceBench dataset. Our evaluation is grounded in factual accuracy, which allows us to measure the e ff ectiveness of each configuration by its precision in retrieving answers that match the ground truth, as well as its generation abilities.', 'prov': [{'page_no': 8, 'bbox': {'l': 134.76, 't': 344.555, 'r': 491.651, 'b': 299.828, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 318.0]}], 'level': None}, {'label': 'text', 'content': 'We are considering 80 documents and 141 questions from FinanceBench. Using the OpenAI tokenizer from the model text-embedding-ada-002 that uses the tokenizer cl100k base 11 , there are on average 102,444.35 tokens with std of 61,979.45, which shows the large variability of document lengths as seen by the di ff erent number of pages per document presented above.', 'prov': [{'page_no': 8, 'bbox': {'l': 134.76, 't': 296.195, 'r': 480.716, 'b': 239.58799999999997, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 363.0]}], 'level': None}, {'label': 'text', 'content': 'Chunking E ffi ciency The first thing we analyzed is the total number of chunks, as it impacts indexing time. We would like to observe the relationship between accuracy and total chunk size. Table 3 shows the number of chunks derived from each one of the processing methods. Unstructured element-based chunks are closer in size to Base 512, and as the chunk size decreases for the basic chunking strategies, the total number of chunks increases linearly.', 'prov': [{'page_no': 8, 'bbox': {'l': 134.76, 't': 216.03499999999997, 'r': 480.731, 'b': 147.428, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 454.0]}], 'level': None}, {'label': 'footnote', 'content': '11 https://platform.openai.com/docs/guides/embeddings/limitations-risks', 'prov': [{'page_no': 8, 'bbox': {'l': 133.8, 't': 136.42700000000002, 'r': 465.277, 'b': 127.30500000000006, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 71.0]}], 'level': None}, {'label': 'text', 'content': 'Retrieval Accuracy Secondly, we evaluate the capabilities of each chunking strategy in terms of retrieval accuracy. We use the page numbers in the ground truth to calculate the page-level retrieval accuracy, and we use ROUGE [24] and BLEU [32] scores to evaluate the accuracy of paragraph-level retrieval compared to the ground truth evidence paragraphs.', 'prov': [{'page_no': 9, 'bbox': {'l': 134.76, 't': 255.995, 'r': 480.73, 'b': 199.26800000000003, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 354.0]}], 'level': None}, {'label': 'text', 'content': ""As shown in Table 4, when compared to Unstructured element-based chunking strategies, basic chunking strategies seem to have higher page-level retrieval accuracy but lower paragraph-level accuracy on average. Additionally, basic chunking strategies also lack consistency between page-level and paragraph-level accuracy; higher page-level accuracy doesn't ensure higher paragraph-level accuracy. For example, Base 128 has the second highest page-level accuracy but"", 'prov': [{'page_no': 9, 'bbox': {'l': 134.76, 't': 195.515, 'r': 480.962, 'b': 126.90800000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 463.0]}], 'level': None}, {'label': 'text', 'content': 'the lowest paragraph-level scores among all. On the other hand, element-based chunking strategies showed more consistent results.', 'prov': [{'page_no': 10, 'bbox': {'l': 134.76, 't': 672.875, 'r': 480.732, 'b': 652.028, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 129.0]}], 'level': None}, {'label': 'text', 'content': 'A fascinating discovery is that when various chunking strategies are combined, it results in enhanced retrieval scores, achieving superior performance at both the page level (84.4%) and paragraph level (with ROUGE at 0.568% and BLEU at 0.452%). This finding addresses an unresolved question: how to improve the accuracy of RAG.', 'prov': [{'page_no': 10, 'bbox': {'l': 134.76, 't': 648.635, 'r': 480.859, 'b': 592.028, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 327.0]}], 'level': None}, {'label': 'text', 'content': 'The element based method provides the highest scores and it also provides a mechanism to chunk documents without the need to fine tune hyper-parameters like the number of tokens in a chunk. This suggests the element based method is more generalizable and can be applied to new types of documents.', 'prov': [{'page_no': 10, 'bbox': {'l': 134.76, 't': 588.635, 'r': 480.927, 'b': 543.908, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 296.0]}], 'level': None}, {'label': 'text', 'content': 'Q&A Accuracy Third, we evaluate the Q&A accuracy for the chunking strategies. In addition to manual evaluation, we have investigated an automatic evaluation using GPT-4. GPT-4 compares how the answers provided by our method are similar to or di ff erent from the FinanceBench gold standard, similar approaches have been previously evaluated [13,23,29,30]. The automatic evaluation allows scaling the evaluation e ff orts for the di ff erent chunking strategies that we have considered. We used the prompt template in figure 4.', 'prov': [{'page_no': 10, 'bbox': {'l': 134.76, 't': 521.675, 'r': 480.806, 'b': 441.068, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 526.0]}], 'level': None}, {'label': 'code', 'content': ""Begin with True or False. Are the two following answers (Answer 1 and Answer 2) the same with respect to the question between single quotes '{question}'? Answer 1: '{ground_truth_answer}' Answer 2: '{generated_answer}'"", 'prov': [{'page_no': 10, 'bbox': {'l': 145.08, 't': 412.323, 'r': 469.832, 'b': 350.146, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 218.0]}], 'level': None}, {'label': 'text', 'content': 'Results in table 5 show that element-based chunking strategies o ff er the best question-answering accuracy, which is consistent with page retrieval and paragraph retrieval accuracy.', 'prov': [{'page_no': 10, 'bbox': {'l': 134.76, 't': 279.395, 'r': 480.8, 'b': 246.668, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 182.0]}], 'level': None}, {'label': 'text', 'content': 'Lastly, our approach stands out for its e ffi ciency. Not only is element-based chunking generalizable without the need to select the chunk size, but when compared to the aggregation results that yield the highest retrieval scores. Elementbased chunking achieves the highest retrieval scores with only half the number of chunks required compared to methods that do not consider the structure of the documents (62,529 v.s. 112,155). This can reduce the indexing cost and improve query latency because there are only half as many vectors to index for the vectordb that stores the chunks. This underscores the e ff ectiveness of our solution in optimizing the balance between performance and computational resource requirements.', 'prov': [{'page_no': 10, 'bbox': {'l': 134.76, 't': 243.27499999999998, 'r': 480.838, 'b': 126.90800000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 725.0]}], 'level': None}, {'label': 'section_header', 'content': '5 Discussion', 'prov': [{'page_no': 11, 'bbox': {'l': 134.76, 't': 351.116, 'r': 216.151, 'b': 341.545, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 12.0]}], 'level': 1}, {'label': 'text', 'content': 'Results demonstrate the e ffi cacy of our approach in utilizing structural elements for chunking, which has enabled us to attain state-of-the-art performance on Q&A tasks within the FinanceBench dataset (accuracy of 50% vs 53.19%) when an index is created from document chunks and used for generation. This method, which we refer to as element base chunking , has shown to yield consistent results between retrieval and Q&A accuracy.', 'prov': [{'page_no': 11, 'bbox': {'l': 134.76, 't': 318.275, 'r': 480.687, 'b': 249.668, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 433.0]}], 'level': None}, {'label': 'text', 'content': 'We have observed that using basic 512 chunking strategies produces results most similar to the Unstructured element-based approach, which may be due to the fact that 512 tokens share a similar length with the token size within our element-based chunks and capture a long context, but fail keep a coherent context in some cases, leaving out relevant information required for Q&A. This is further observed when considering the ROUGE and BLEU scores in table 4, where the chunk contexts for the baseline have lower scores.', 'prov': [{'page_no': 11, 'bbox': {'l': 134.76, 't': 244.95500000000004, 'r': 480.749, 'b': 164.34799999999996, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 519.0]}], 'level': None}, {'label': 'text', 'content': 'These findings support existing research stating that the best basic chunk size varies from data to data [3]. These results show, as well, that our method adapts to di ff erent documents without tuning. Our method relies on the struc-', 'prov': [{'page_no': 11, 'bbox': {'l': 134.76, 't': 159.635, 'r': 480.684, 'b': 126.90800000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 234.0]}], 'level': None}, {'label': 'text', 'content': ""tural information that is present in the document's layout to adjust the chunk size automatically."", 'prov': [{'page_no': 12, 'bbox': {'l': 134.76, 't': 672.875, 'r': 480.564, 'b': 652.028, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 98.0]}], 'level': None}, {'label': 'text', 'content': 'We have evaluated aggregating the output of di ff erent chunking methods in the retrieval experiments as sown in table 4. Even though the aggregation seems to be e ff ective for retrieval, the Q&A exceeded the GPT-4 token limit, which resulted in a non-e ff ective Q&A solution using the selected model.', 'prov': [{'page_no': 12, 'bbox': {'l': 134.76, 't': 648.515, 'r': 480.609, 'b': 603.788, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 303.0]}], 'level': None}, {'label': 'text', 'content': 'As well, we evaluated variations of the prompt used to generate the answers (see figure 3). Re-ordering the retrieval context and the question, but results were not statistically di ff erent. We experimented as well with variations of the verbs using in the prompt, e.g. changing referencing with using , which seemed to lower the quality of the answers generated. This shows that prompt engineering is a relevant factor in RAG.', 'prov': [{'page_no': 12, 'bbox': {'l': 134.76, 't': 600.275, 'r': 480.818, 'b': 531.668, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 428.0]}], 'level': None}, {'label': 'text', 'content': 'We evaluated using GPT-4 for evaluation instead of relying on manual evaluation. In most cases, GPT-4 evaluated correctly but failed when a more elaborate answer is provided. As shown in figure 5, the answer is 39.7% while the estimated answer is 39.73% but with a detailed explanation of the calculation.', 'prov': [{'page_no': 12, 'bbox': {'l': 134.76, 't': 528.155, 'r': 480.704, 'b': 483.428, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 305.0]}], 'level': None}, {'label': 'code', 'content': ""Question: 'What is Coca Cola's FY2021 COGS % margin? Calculate what was asked by utilizing the line items clearly shown in the income statement.'? Answer 1: '39.7%' Answer 2: 'From the income statement referenced on page 60 of COCACOLA_2021_10K_embedded.json, we can see that Coca Cola's total revenue in FY2021 was $38,655 million and their cost of goods sold (COGS) was $15,357 million. To calculate the COGS % margin, we divide the COGS by the total revenue and multiply by 100: (15,357 / 38,655) * 100 = 39.73% So, Coca Cola's FY2021 COGS % margin was approximately 39.73%.'"", 'prov': [{'page_no': 12, 'bbox': {'l': 145.08, 't': 454.323, 'r': 469.843, 'b': 326.505, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 578.0]}], 'level': None}, {'label': 'section_header', 'content': '6 Conclusions and Future Work', 'prov': [{'page_no': 12, 'bbox': {'l': 134.76, 't': 246.596, 'r': 330.851, 'b': 237.02499999999998, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 29.0]}], 'level': 1}, {'label': 'text', 'content': 'Results show that our element based chunking strategy improves the state-of-theart Q&A for the task, which is achieved by providing a better chunking strategy for the processed documents. We provide comparison with baseline chunking strategies that allow us to draw conclusions about di ff erent chunking methods.', 'prov': [{'page_no': 12, 'bbox': {'l': 134.76, 't': 219.755, 'r': 480.691, 'b': 175.14800000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 313.0]}], 'level': None}, {'label': 'text', 'content': 'As future work, we would like to perform a similar evaluation in other domains, e.g. biomedical, to understand how our findings apply outside financial reporting. As well, we would like studying which additional element types and/or relation between elements would support better chunking strategies for RAG.', 'prov': [{'page_no': 12, 'bbox': {'l': 134.76, 't': 171.635, 'r': 480.797, 'b': 126.90800000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 308.0]}], 'level': None}, {'label': 'text', 'content': 'Furthermore, we would like to study the impact of RAG configuration and element type based chunking.', 'prov': [{'page_no': 13, 'bbox': {'l': 134.76, 't': 672.875, 'r': 480.558, 'b': 652.028, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 100.0]}], 'level': None}, {'label': 'section_header', 'content': 'References', 'prov': [{'page_no': 13, 'bbox': {'l': 134.76, 't': 631.916, 'r': 197.667, 'b': 622.345, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 10.0]}], 'level': 1}, {'label': 'list_item', 'content': 'Anantha, R., Bethi, T., Vodianik, D., Chappidi, S.: Context Tuning for Retrieval Augmented Generation (2023)', 'prov': [{'page_no': 13, 'bbox': {'l': 139.32, 't': 610.052, 'r': 480.632, 'b': 591.169, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 111.0]}], 'level': None}, {'label': 'list_item', 'content': 'Balaguer, A., Benara, V., de Freitas Cunha, R.L., de M. Estev˜ ao Filho, R., Hendry, T., Holstein, D., Marsman, J., Mecklenburg, N., Malvar, S., Nunes, L.O., Padilha, R., Sharp, M., Silva, B., Sharma, S., Aski, V., Chandra, R.: Rag vs fine-tuning: Pipelines, tradeo ff s, and a case study on agriculture (2024)', 'prov': [{'page_no': 13, 'bbox': {'l': 139.32, 't': 588.691, 'r': 480.775, 'b': 547.85, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 313.0]}], 'level': None}, {'label': 'list_item', 'content': 'Barnett, S., Kurniawan, S., Thudumu, S., Brannelly, Z., Abdelrazek, M.: Seven Failure Points When Engineering a Retrieval Augmented Generation System (2024)', 'prov': [{'page_no': 13, 'bbox': {'l': 139.319, 't': 545.372, 'r': 480.679, 'b': 515.45, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 159.0]}], 'level': None}, {'label': 'list_item', 'content': 'Bentabet, N.I., Juge, R., El Maarouf, I., Mouilleron, V., Valsamou-Stanislawski, D., El-Haj, M.: The financial document structure extraction shared task (fintoc 2020). In: Proceedings of the 1st Joint Workshop on Financial Narrative Processing and MultiLing Financial Summarisation. pp. 13-22 (2020)', 'prov': [{'page_no': 13, 'bbox': {'l': 139.32, 't': 512.972, 'r': 480.674, 'b': 472.13, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 302.0]}], 'level': None}, {'label': 'list_item', 'content': ""Chen, H., Jiao, F., Li, X., Qin, C., Ravaut, M., Zhao, R., Xiong, C., Joty, S.: ChatGPT's One-year Anniversary: Are Open-Source Large Language Models Catching up? arXiv preprint arXiv:2311.16989 (2023)"", 'prov': [{'page_no': 13, 'bbox': {'l': 139.32, 't': 469.652, 'r': 480.544, 'b': 439.73, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 204.0]}], 'level': None}, {'label': 'list_item', 'content': 'Chen, Z., Chen, W., Smiley, C., Shah, S., Borova, I., Langdon, D., Moussa, R., Beane, M., Huang, T.H., Routledge, B., et al.: Finqa: A dataset of numerical reasoning over financial data. arXiv preprint arXiv:2109.00122 (2021)', 'prov': [{'page_no': 13, 'bbox': {'l': 139.32, 't': 437.252, 'r': 480.653, 'b': 407.45, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 228.0]}], 'level': None}, {'label': 'list_item', 'content': 'Chen, Z., Li, S., Smiley, C., Ma, Z., Shah, S., Wang, W.Y.: ConvFinQA: Exploring the Chain of Numerical Reasoning in Conversational Finance Question Answering (2022)', 'prov': [{'page_no': 13, 'bbox': {'l': 139.321, 't': 404.852, 'r': 480.523, 'b': 375.05, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 168.0]}], 'level': None}, {'label': 'list_item', 'content': 'Choi, S., Gazeley, W., Wong, S.H., Li, T.: Conversational Financial Information Retrieval Model (ConFIRM). arXiv preprint arXiv:2310.13001 (2023)', 'prov': [{'page_no': 13, 'bbox': {'l': 139.321, 't': 372.572, 'r': 480.411, 'b': 353.57, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 148.0]}], 'level': None}, {'label': 'list_item', 'content': 'DeSola, V., Hanna, K., Nonis, P.: Finbert: pre-trained model on sec filings for financial natural language tasks. University of California (2019)', 'prov': [{'page_no': 13, 'bbox': {'l': 139.321, 't': 351.092, 'r': 480.474, 'b': 332.21, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 148.0]}], 'level': None}, {'label': 'list_item', 'content': 'El-Haj, M., Rayson, P., Young, S., Walker, M.: Detecting document structure in a very large corpus of UK financial reports. European Language Resources Association (ELRA) (2014)', 'prov': [{'page_no': 13, 'bbox': {'l': 134.762, 't': 329.732, 'r': 480.624, 'b': 299.81, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 181.0]}], 'level': None}, {'label': 'list_item', 'content': 'El Maarouf, I., Kang, J., Azzi, A.A., Bellato, S., Gan, M., El-Haj, M.: The financial document structure extraction shared task (FinTOC2021). In: Proceedings of the 3rd Financial Narrative Processing Workshop. pp. 111-119 (2021)', 'prov': [{'page_no': 13, 'bbox': {'l': 134.762, 't': 297.332, 'r': 480.61, 'b': 267.53, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 232.0]}], 'level': None}, {'label': 'list_item', 'content': 'Gao, Y., Xiong, Y., Gao, X., Jia, K., Pan, J., Bi, Y., Dai, Y., Sun, J., Wang, H.: Retrieval-augmented generation for large language models: A survey. arXiv preprint arXiv:2312.10997 (2023)', 'prov': [{'page_no': 13, 'bbox': {'l': 134.762, 't': 265.052, 'r': 480.671, 'b': 235.13, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 193.0]}], 'level': None}, {'label': 'list_item', 'content': 'Hada, R., Gumma, V., de Wynter, A., Diddee, H., Ahmed, M., Choudhury, M., Bali, K., Sitaram, S.: Are large language model-based evaluators the solution to scaling up multilingual evaluation? arXiv preprint arXiv:2309.07462 (2023)', 'prov': [{'page_no': 13, 'bbox': {'l': 134.762, 't': 232.65300000000002, 'r': 480.649, 'b': 202.73000000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 233.0]}], 'level': None}, {'label': 'list_item', 'content': 'Islam, P., Kannappan, A., Kiela, D., Qian, R., Scherrer, N., Vidgen, B.: FinanceBench: A New Benchmark for Financial Question Answering. arXiv preprint arXiv:2311.11944 (2023)', 'prov': [{'page_no': 13, 'bbox': {'l': 134.762, 't': 200.25299999999993, 'r': 480.695, 'b': 170.45100000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 179.0]}], 'level': None}, {'label': 'list_item', 'content': 'Ji, Z., Lee, N., Frieske, R., Yu, T., Su, D., Xu, Y., Ishii, E., Bang, Y.J., Madotto, A., Fung, P.: Survey of Hallucination in Natural Language Generation. ACM Computing Surveys 55 (12), 1-38 (Mar 2023). https://doi.org/10.1145/3571730, http:// dx.doi.org/10.1145/3571730', 'prov': [{'page_no': 13, 'bbox': {'l': 134.762, 't': 167.97299999999996, 'r': 480.653, 'b': 127.30600000000004, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 275.0]}], 'level': None}, {'label': 'list_item', 'content': 'Jiang, A.Q., Sablayrolles, A., Roux, A., Mensch, A., Savary, B., Bamford, C., Chaplot, D.S., de las Casas, D., Hanna, E.B., Bressand, F., Lengyel, G., Bour, G., Lample, G., Lavaud, L.R., Saulnier, L., Lachaux, M.A., Stock, P., Subramanian, S., Yang, S., Antoniak, S., Scao, T.L., Gervet, T., Lavril, T., Wang, T., Lacroix, T., Sayed, W.E.: Mixtral of Experts (2024)', 'prov': [{'page_no': 14, 'bbox': {'l': 134.76, 't': 672.211, 'r': 480.652, 'b': 620.329, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 369.0]}], 'level': None}, {'label': 'list_item', 'content': 'Juge, R., Bentabet, I., Ferradans, S.: The fintoc-2019 shared task: Financial document structure extraction. In: Proceedings of the Second Financial Narrative Processing Workshop (FNP 2019). pp. 51-57 (2019)', 'prov': [{'page_no': 14, 'bbox': {'l': 134.76, 't': 618.092, 'r': 480.648, 'b': 588.17, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 211.0]}], 'level': None}, {'label': 'list_item', 'content': 'Kaddour, J., Harris, J., Mozes, M., Bradley, H., Raileanu, R., McHardy, R.: Challenges and applications of large language models. arXiv preprint arXiv:2307.10169 (2023)', 'prov': [{'page_no': 14, 'bbox': {'l': 134.76, 't': 585.932, 'r': 480.427, 'b': 556.01, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 172.0]}], 'level': None}, {'label': 'list_item', 'content': ""Kaur, S., Smiley, C., Gupta, A., Sain, J., Wang, D., Siddagangappa, S., Aguda, T., Shah, S.: REFinD: Relation Extraction Financial Dataset. In: Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval. SIGIR '23, ACM (Jul 2023). https://doi.org/10.1145/3539618.3591911, http://dx.doi.org/10.1145/ 3539618.3591911"", 'prov': [{'page_no': 14, 'bbox': {'l': 134.76, 't': 553.772, 'r': 480.663, 'b': 491.266, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 371.0]}], 'level': None}, {'label': 'list_item', 'content': 'Kim, G., Hong, T., Yim, M., Park, J., Yim, J., Hwang, W., Yun, S., Han, D., Park, S.: Donut: Document understanding transformer without ocr. arXiv preprint arXiv:2111.15664 7 , 15 (2021)', 'prov': [{'page_no': 14, 'bbox': {'l': 134.76, 't': 488.732, 'r': 480.69, 'b': 458.93, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 190.0]}], 'level': None}, {'label': 'list_item', 'content': 'Lewis, P., Perez, E., Piktus, A., Petroni, F., Karpukhin, V., Goyal, N., K uttler, H., Lewis, M., Yih, W.t., Rockt aschel, T., et al.: Retrieval-augmented generation for knowledge-intensive NLP tasks. Advances in Neural Information Processing Systems 33 , 9459-9474 (2020)', 'prov': [{'page_no': 14, 'bbox': {'l': 134.76, 't': 456.572, 'r': 480.502, 'b': 415.73, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 276.0]}], 'level': None}, {'label': 'list_item', 'content': 'Li, D., Shao, R., Xie, A., Sheng, Y., Zheng, L., Gonzalez, J.E., Stoica, I., Ma, X., Zhang, H.: How Long Can Open-Source LLMs Truly Promise on Context Length? (June 2023), https://lmsys.org/blog/2023-06-29-longchat', 'prov': [{'page_no': 14, 'bbox': {'l': 134.76, 't': 413.492, 'r': 480.65, 'b': 383.57, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 218.0]}], 'level': None}, {'label': 'list_item', 'content': 'Li, Y., Duan, Y.: The evaluation of experiments of artificial general intelligence with gpt-4 based on dikwp. arXiv preprint (2023)', 'prov': [{'page_no': 14, 'bbox': {'l': 134.76, 't': 381.332, 'r': 480.532, 'b': 362.45, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 135.0]}], 'level': None}, {'label': 'list_item', 'content': 'Lin, C.Y.: Rouge: A package for automatic evaluation of summaries. In: Text summarization branches out. pp. 74-81 (2004)', 'prov': [{'page_no': 14, 'bbox': {'l': 134.76, 't': 360.092, 'r': 480.53, 'b': 341.21, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 124.0]}], 'level': None}, {'label': 'list_item', 'content': 'Liu, N.F., Lin, K., Hewitt, J., Paranjape, A., Bevilacqua, M., Petroni, F., Liang, P.: Lost in the middle: How language models use long contexts. arXiv preprint arXiv:2307.03172 (2023)', 'prov': [{'page_no': 14, 'bbox': {'l': 134.76, 't': 338.972, 'r': 480.683, 'b': 309.05, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 188.0]}], 'level': None}, {'label': 'list_item', 'content': 'Liu, Z., Huang, D., Huang, K., Li, Z., Zhao, J.: Finbert: A pre-trained financial language representation model for financial text mining. In: Proceedings of the twenty-ninth international conference on international joint conferences on artificial intelligence. pp. 4513-4519 (2021)', 'prov': [{'page_no': 14, 'bbox': {'l': 134.76, 't': 306.812, 'r': 480.596, 'b': 265.97, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 287.0]}], 'level': None}, {'label': 'list_item', 'content': 'llmware: Rag Instruct Benchmark Tester. https://huggingface.co/datasets/ llmware/rag_instruct_benchmark_tester , Accessed: January 15, 2024', 'prov': [{'page_no': 14, 'bbox': {'l': 134.76, 't': 263.6120000000001, 'r': 480.393, 'b': 244.73000000000002, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 143.0]}], 'level': None}, {'label': 'list_item', 'content': 'Malkov, Y.A., Yashunin, D.A.: E ffi cient and robust approximate nearest neighbor search using hierarchical navigable small world graphs. IEEE transactions on pattern analysis and machine intelligence 42 (4), 824-836 (2018)', 'prov': [{'page_no': 14, 'bbox': {'l': 134.76, 't': 242.49199999999996, 'r': 480.588, 'b': 212.56999999999994, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 227.0]}], 'level': None}, {'label': 'list_item', 'content': 'Moore, S., Nguyen, H.A., Chen, T., Stamper, J.: Assessing the quality of multiplechoice questions using gpt-4 and rule-based methods. In: European Conference on Technology Enhanced Learning. pp. 229-245. Springer (2023)', 'prov': [{'page_no': 14, 'bbox': {'l': 134.76, 't': 210.33299999999997, 'r': 480.558, 'b': 180.40999999999997, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 223.0]}], 'level': None}, {'label': 'list_item', 'content': 'Naismith, B., Mulcaire, P., Burstein, J.: Automated evaluation of written discourse coherence using gpt-4. In: Proceedings of the 18th Workshop on Innovative Use of NLP for Building Educational Applications (BEA 2023). pp. 394-403 (2023)', 'prov': [{'page_no': 14, 'bbox': {'l': 134.76, 't': 178.17200000000003, 'r': 480.554, 'b': 148.25099999999998, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 241.0]}], 'level': None}, {'label': 'list_item', 'content': 'OpenAI, :, Achiam, J., Adler, S., Agarwal, S., et al.: GPT-4 Technical Report (2023)', 'prov': [{'page_no': 14, 'bbox': {'l': 134.76, 't': 146.01199999999994, 'r': 480.574, 'b': 127.13, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 88.0]}], 'level': None}, {'label': 'list_item', 'content': 'Papineni, K., Roukos, S., Ward, T., Zhu, W.J.: Bleu: a method for automatic evaluation of machine translation. In: Proceedings of the 40th annual meeting of the Association for Computational Linguistics. pp. 311-318 (2002)', 'prov': [{'page_no': 15, 'bbox': {'l': 134.76, 't': 672.211, 'r': 480.541, 'b': 642.289, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 226.0]}], 'level': None}, {'label': 'list_item', 'content': 'Pfitzmann, B., Auer, C., Dolfi, M., Nassar, A.S., Staar, P.: Doclaynet: A large human-annotated dataset for document-layout segmentation. In: Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining. pp. 3743-3751 (2022)', 'prov': [{'page_no': 15, 'bbox': {'l': 134.76, 't': 639.332, 'r': 480.52, 'b': 598.49, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 252.0]}], 'level': None}, {'label': 'list_item', 'content': 'Pinecone: Chunking strategies for llm applications, https://www.pinecone.io/ learn/chunking-strategies/', 'prov': [{'page_no': 15, 'bbox': {'l': 134.76, 't': 595.412, 'r': 480.518, 'b': 576.705, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 107.0]}], 'level': None}, {'label': 'list_item', 'content': 'Reimers, N., Gurevych, I.: Sentence-bert: Sentence embeddings using siamese bertnetworks. In: Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing. Association for Computational Linguistics (11 2019), https://arxiv.org/abs/1908.10084', 'prov': [{'page_no': 15, 'bbox': {'l': 134.76, 't': 573.572, 'r': 480.568, 'b': 532.906, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 271.0]}], 'level': None}, {'label': 'list_item', 'content': 'Retteter, J.: Mastering Table Extraction: Revolutionize Your Earnings Reports Analysis with AI. https://medium.com/unstructured-io/masteringtable-extraction-revolutionize-your-earnings-reports-analysis-withai-1bc32c22720e , Accessed: January 15, 2024', 'prov': [{'page_no': 15, 'bbox': {'l': 134.76, 't': 529.652, 'r': 480.702, 'b': 488.81, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 254.0]}], 'level': None}, {'label': 'list_item', 'content': 'Rizinski, M., Peshov, H., Mishev, K., Jovanovik, M., Trajanov, D.: Sentiment Analysis in Finance: From Transformers Back to eXplainable Lexicons (XLex) (2023)', 'prov': [{'page_no': 15, 'bbox': {'l': 134.76, 't': 485.852, 'r': 480.561, 'b': 466.97, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 162.0]}], 'level': None}, {'label': 'list_item', 'content': 'Shah, R.S., Chawla, K., Eidnani, D., Shah, A., Du, W., Chava, S., Raman, N., Smiley, C., Chen, J., Yang, D.: WHEN FLUE MEETS FLANG: Benchmarks and Large Pre-trained Language Model for Financial Domain (2022)', 'prov': [{'page_no': 15, 'bbox': {'l': 134.76, 't': 464.012, 'r': 480.637, 'b': 434.09, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 211.0]}], 'level': None}, {'label': 'list_item', 'content': 'Singh Phogat, K., Harsha, C., Dasaratha, S., Ramakrishna, S., Akhil Puranam, S.: Zero-Shot Question Answering over Financial Documents using Large Language Models. arXiv e-prints pp. arXiv-2311 (2023)', 'prov': [{'page_no': 15, 'bbox': {'l': 134.76, 't': 431.132, 'r': 480.647, 'b': 401.21, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 204.0]}], 'level': None}, {'label': 'list_item', 'content': 'Wu, S., Irsoy, O., Lu, S., Dabravolski, V., Dredze, M., Gehrmann, S., Kambadur, P., Rosenberg, D., Mann, G.: BloombergGPT: A Large Language Model for Finance (2023)', 'prov': [{'page_no': 15, 'bbox': {'l': 134.76, 't': 398.252, 'r': 480.517, 'b': 368.33, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 168.0]}], 'level': None}, {'label': 'list_item', 'content': 'Xu, P., Ping, W., Wu, X., McAfee, L., Zhu, C., Liu, Z., Subramanian, S., Bakhturina, E., Shoeybi, M., Catanzaro, B.: Retrieval meets Long Context Large Language Models (2023)', 'prov': [{'page_no': 15, 'bbox': {'l': 134.76, 't': 365.372, 'r': 480.674, 'b': 335.45, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 178.0]}], 'level': None}, {'label': 'list_item', 'content': 'Yang, H., Liu, X.Y., Wang, C.D.: FinGPT: Open-Source Financial Large Language Models (2023)', 'prov': [{'page_no': 15, 'bbox': {'l': 134.76, 't': 332.492, 'r': 480.504, 'b': 313.49, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 95.0]}], 'level': None}, {'label': 'list_item', 'content': 'Ye, H., Liu, T., Zhang, A., Hua, W., Jia, W.: Cognitive Mirage: A Review of Hallucinations in Large Language Models (2023)', 'prov': [{'page_no': 15, 'bbox': {'l': 134.76, 't': 310.533, 'r': 480.521, 'b': 291.65, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 126.0]}], 'level': None}, {'label': 'list_item', 'content': 'Zhang, B., Yang, H., Liu, X.Y.: Instruct-FinGPT: Financial Sentiment Analysis by Instruction Tuning of General-Purpose Large Language Models (2023)', 'prov': [{'page_no': 15, 'bbox': {'l': 134.76, 't': 288.572, 'r': 480.664, 'b': 269.69000000000005, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 151.0]}], 'level': None}, {'label': 'list_item', 'content': 'Zheng, X., Burdick, D., Popa, L., Zhong, X., Wang, N.X.R.: Global table extractor (gte): A framework for joint table identification and cell structure recognition using visual context. In: Proceedings of the IEEE/CVF winter conference on applications of computer vision. pp. 697-706 (2021)', 'prov': [{'page_no': 15, 'bbox': {'l': 134.76, 't': 266.73299999999995, 'r': 480.616, 'b': 225.89, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 293.0]}], 'level': None}, {'label': 'list_item', 'content': 'Zhu, F., Lei, W., Huang, Y., Wang, C., Zhang, S., Lv, J., Feng, F., Chua, T.S.: TAT-QA: A question answering benchmark on a hybrid of tabular and textual content in finance. arXiv preprint arXiv:2105.07624 (2021)', 'prov': [{'page_no': 15, 'bbox': {'l': 134.76, 't': 222.813, 'r': 480.66, 'b': 193.01, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 216.0]}], 'level': None}]","[{'label': 'table', 'prov': [{'page_no': 8, 'bbox': {'l': 226.549072265625, 't': 649.5025939941406, 'r': 385.684326171875, 'b': 503.4220886230469, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 0.0]}], 'caption': ['Table 1. Unstructured element types distribution for Chipper predictions against documents in FinanceBench.'], 'content': '| Element Type      | Chipper Entities   |\n|:------------------|:-------------------|\n| NarrativeText     | 61,780             |\n| Title             | 29,664             |\n| ListItem          | 33,054             |\n| UncategorizedText | 9,400              |\n| Footer            | 1,026              |\n| Table             | 7,700              |\n| Header            | 3,959              |\n| Image             | 26                 |\n| FigureCaption     | 54                 |\n| Formula           | 29                 |\n| Address           | 229                |\n| Total             | 146,921            |'}, {'label': 'table', 'prov': [{'page_no': 9, 'bbox': {'l': 133.40847778320312, 't': 649.3876953125, 'r': 487.2038269042969, 'b': 391.8861999511719, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 0.0]}], 'caption': ['Table 2. Example question from the FinanceBench dataset'], 'content': ""| Field                                 | Value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |\n|:--------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| financebench id financebench id 00859 | financebench id financebench id 00859                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |\n| doc name                              | VERIZON 2021 10K                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |\n| doc link                              | https://www.verizon.com/about/sites/default/files/2021-Annual- Report-on-Form-10-K.pdf                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |\n| question type                         | 'novel-generated'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |\n| question                              | Among all of the derivative instruments that Verizon used to manage the exposure to fluctuations of foreign currencies exchange rates or interest rates, which one had the highest notional value in FY 2021?                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |\n| answer                                | Cross currency swaps. Its notional value was $ 32,502 million.,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |\n| evidence text                         | Derivative Instruments We enter into derivative transactions primarily to manage our exposure to fluctuations in foreign currency exchange rates and interest rates. We employ risk management strategies, which may include the use of a variety of derivatives including interest rate swaps, cross currency swaps, forward starting interest rate swaps, trea- sury rate locks, interest rate caps, swaptions and foreign exchange for- wards. We do not hold derivatives for trading purposes. The following table sets forth the notional amounts of our outstanding derivative in- struments: (dollars in millions) At December 31, 2021 2020 Interest rate swaps $ 19,779 $ 17,768 Cross currency swaps 32,502 26,288 Forward starting interest rate swaps 1,000 2,000 Foreign exchange forwards 932 1,405 |\n| page number                           | 85                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |""}, {'label': 'table', 'prov': [{'page_no': 9, 'bbox': {'l': 152.92388916015625, 't': 350.36297607421875, 'r': 462.16912841796875, 'b': 292.6167907714844, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 0.0]}], 'caption': ['Table 3. Chunks statistics for basic chunking elements and Unstructured elements'], 'content': '| Processing total chunks mean chunks per document (std) tables mean (std)   | Processing total chunks mean chunks per document (std) tables mean (std)   | Processing total chunks mean chunks per document (std) tables mean (std)   | Processing total chunks mean chunks per document (std) tables mean (std)   |\n|:---------------------------------------------------------------------------|:---------------------------------------------------------------------------|:---------------------------------------------------------------------------|:---------------------------------------------------------------------------|\n| Base 128                                                                   | 64,058                                                                     | 800.73 (484.11)                                                            | N/A                                                                        |\n| Base 256                                                                   | 32,051                                                                     | 400.64 (242.04)                                                            | N/A                                                                        |\n| Base 512                                                                   | 16,046                                                                     | 200.58 (121.01)                                                            | N/A                                                                        |\n| Chipper                                                                    | 20,843                                                                     | 260.57 (145.80)                                                            | 96.20 (57.53)                                                              |'}, {'label': 'table', 'prov': [{'page_no': 11, 'bbox': {'l': 140.2692413330078, 't': 625.2447509765625, 'r': 474.18865966796875, 'b': 522.2947692871094, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 0.0]}], 'caption': ['Table 4. Retrieval results. For each chunking strategy, we show the number of chunks for all the documents (Total Chunks), Page Accuracy, and ROUGE and BLEU scores. ROUGE and BLEU are calculated as the maximum score from the list of recovered contexts for a question when compared to the known evidence for that question.'], 'content': '| Chunking strategy                  | Total Chunks   |   Page Accuracy |   ROUGE |   BLEU |\n|:-----------------------------------|:---------------|----------------:|--------:|-------:|\n| Base 128                           | 64,058         |           72.34 |   0.383 |  0.181 |\n| Base 256                           | 32,051         |           73.05 |   0.433 |  0.231 |\n| Base 512                           | 16,046         |           68.09 |   0.455 |  0.25  |\n| Base Aggregation                   | 112,155        |           83.69 |   0.536 |  0.277 |\n| Keywords Chipper                   | 20,843         |           46.1  |   0.444 |  0.315 |\n| Summary Chipper                    | 20,843         |           62.41 |   0.473 |  0.35  |\n| Prefix & Table Description Chipper | 20,843         |           67.38 |   0.514 |  0.4   |\n| Chipper Aggregation                | 62,529         |           84.4  |   0.568 |  0.452 |'}, {'label': 'table', 'prov': [{'page_no': 11, 'bbox': {'l': 178.77072143554688, 't': 468.6895751953125, 'r': 436.1873474121094, 'b': 389.03924560546875, 'coord_origin': 'BOTTOMLEFT'}, 'charspan': [0.0, 0.0]}], 'caption': ['Table 5. Q&A results. We show the percentage of questions with no answer and as well the accuracy either estimated automatically using GPT-4 or manually.'], 'content': '| Chunking strategy                  |   No answer |   GPT-4 |   Manual |\n|:-----------------------------------|------------:|--------:|---------:|\n| Base 128                           |       35.46 |   29.08 |    35.46 |\n| Base 256                           |       25.53 |   32.62 |    36.88 |\n| Base 512                           |       24.82 |   41.84 |    48.23 |\n| Keywords Chipper                   |       22.7  |   43.97 |    53.19 |\n| Summary Chipper                    |       17.73 |   43.97 |    51.77 |\n| Prefix & Table Description Chipper |       20.57 |   41.13 |    53.19 |'}]",[],"## Financial Report Chunking for E ff ective Retrieval Augmented Generation

Antonio Jimeno Yepes, Yao You, Jan Milczek, Sebastian Laverde, and Renyu Li

Unstructured Technologies Sacramento, CA, USA leah@unstructured.io https://unstructured.io

Abstract. Chunking information is a key step in Retrieval Augmented Generation (RAG). Current research primarily centers on paragraphlevel chunking. This approach treats all texts as equal and neglects the information contained in the structure of documents. We propose an expanded approach to chunk documents by moving beyond mere paragraph-level chunking to chunk primary by structural element components of documents. Dissecting documents into these constituent elements creates a new way to chunk documents that yields the best chunk size without tuning. We introduce a novel framework that evaluates how chunking based on element types annotated by document understanding models contributes to the overall context and accuracy of the information retrieved. We also demonstrate how this approach impacts RAG assisted Question &amp; Answer task performance. Our research includes a comprehensive analysis of various element types, their role in e ff ective information retrieval, and the impact they have on the quality of RAG outputs. Findings support that element type based chunking largely improve RAG results on financial reporting. Through this research, we are also able to answer how to uncover highly accurate RAG.

Keywords: Retrieval Augmented Generation · Document Chunking · Document Pre-Processing · Financial Domain · Large Language Models

## 1 Introduction

Existing approaches for document understanding use a combination of methods from the computer vision and natural language processing domains to identify the di ff erent components in a document. In the rapidly evolving landscape of artificial intelligence, the capability to e ff ectively process unstructured data is becoming increasingly critical. Large Language Models (LLMs) like GPT-4 have revolutionized natural language understanding and generation, as evidenced by their prompt-based functionalities [31], enabling a wide range of applications [5]. However, the e ffi cacy of these models is often constrained by their reliance on the size and quality of the data they process. A notable limitation is the restricted contextual window of LLMs, which hampers their ability to fully comprehend the

contents of extensive documents [25,22,18]. By dissecting large volumes of text into smaller, more focused segments, LLMs can process each part with greater precision, ensuring a thorough understanding of each section. This segmented approach allows for meticulous analysis of unstructured data, enabling LLMs to construct a more comprehensive and coherent understanding of the entire document [41]. There remains a challenge in ensuring factual accuracy and relevance in the generated responses, especially when dealing with complex or extensive information.

Recently, Retrieval Augmented Generation (RAG) [21,12] has been developed to address the hallucination problem with LLMs [15,43] when recovering factual information directly from an LLM. In RAG, instead of answering a user query directly using an LLM, the user query is used to retrieve documents or segments from a corpus and the top retrieved documents or segments are used to generate the answer in conjunction with an LLM. In this way, RAG constraints the answer to the set of retrieved documents. RAGs have been used as well to answer questions from single documents [14]. The documents are split into smaller parts or chunks, indexed by a retrieval system and recovered and processed depending on the user information need. In a sense, this process allows answering questions about information in a single document, thus contributing to the set of techniques available for document understanding.

Since documents need to be chunked for RAG processing, this raises the question about what is the best practice to chunk documents for e ff ective RAG document understanding. There are several dimensions to consider when deciding how to chunk a document, which includes the size of the chunks.

The retrieval system in RAG can use traditional retrieval systems using bagof-words methods or a vector database. If a vector database is used, then an embedding needs to be obtained from each chunk, thus the number of tokens in the chunk is relevant since the neural networks processing the chunks might have constraints on the number of tokens. As well, di ff erent chunk sizes might have undesirable retrieval results. Since the most relevant retrieved chunks need to be processed by an LLM, the number of tokens in retrieved chunks might have an e ff ect in the generation of the answer [25]. As we see, chunking is required for RAG systems and there are several advantages and disadvantages when considering how to chunk a document.

In this work, we study specifically the chunking of U.S. Securities and Exchange Commission (SEC) 1 Financial Reports 2 , including 10-Ks, 10-Qs, and 8-Ks. This study plays a critical role in o ff ering insights into the financial health and operational dynamics of public companies. These documents present unique challenges in terms of document processing and information extraction as they consist of varying sizes and layouts, and contain a variety of tabular information. Previous work has evaluated the processing of these reports with simple chunking strategies (e.g., tokens), but we believe that a more e ff ective use of these reports might be achieved by a better pre-processing of the documents

1 https://www.sec.gov

2 https://www.sec.gov/files/cf-frm.pdf

and chunking configuration 3 [14]. To the best of our knowledge, this is the first systematic study on chunking for document understanding and more specifically for processing financial reports.

## 2 Related work

RAG is an innovative method that has emerged to enhance the performance of LLMs by incorporating external knowledge, thereby boosting their capabilities. This technique has undergone substantial research, examining various configurations and applications. Key research includes Gao et al.'s [12] detailed analysis of RAG configurations and their role in enhancing Natural Language Processing (NLP) tasks, reducing errors, and improving factual accuracy. Several context retrieval methods are proposed to dynamically retrieve documents to improve the coherence of generated outputs [1]. Other research introduced advancements in RAG, including reasoning chain storage and optimization strategies for retrieval, respectively, broadening the scope and e ffi ciency of RAG applications in LLMs [21]. More recent work has compared RAG vs LLM fine-tuning, and identified that applying both improves the performance of each individual method [2].

Chunking has been identified as the key factor in the success of RAG, improving the relevance of retrieved content by ensuring accurate embedding of text with minimal noise. Various strategies have been developed for text subdivision, each with its unique approach. They can be summarized as follows: the fixed size strategy divides text into uniform segments, but it often overlooks the underlying textual structure. In contrast, the recursive strategy iteratively subdivides text using separators like punctuation marks, allowing it to adapt more fluidly to the content. The contextual strategy takes this a step further by employing NLP techniques such as sentence segmentation to represent the meaning in context. Lastly, the hybrid strategy combines di ff erent approaches, o ff ering greater flexibility in handling diverse text types [34]. However, an area yet to be explored in RAG chunking based on element types (document structure), which involves analyzing the inherent structure of documents, such as headings, paragraphs, tables, to guide the chunking process. Although chunking by Markdown and LaTeX comes closer to addressing element types, it's not the same in nature as a dedicated approach that directly considers document structure and element types for chunking, which could potentially yield more contextually relevant chunks.

Exploring the structure of financial reports is an exceptional area for establishing optimal principles for chunking. The intricate nature of document structures and contents has resulted in most of the work processing financial reports focusing on the identification of structural elements. Among previous work, we find El-Haj et al. [10] and the FinTOC challenges [17,4,11] that have worked at the document structure level for UK and French financial reports. Ad-

3 https://www.cnbc.com/2023/12/19/gpt-and-other-ai-models-cant-analyzean-sec-filing-researchers-find.html

ditionally, there is recent work that considers U.S. SEC reports, which includes DocLayNet [33] and more specifically with the report tables in FinTabNet [45].

On the side of financial models, there is work in sentiment analysis in finance [37], which includes the pre-training of specialised models such as FinBERT by Liu et al. [26], which is a BERT based model pre-trained on large corpora including large collections of financial news collected from di ff erent sites and FinBERT by DeSola et al, [9] trained on Wikipedia, BookCorpus and U.S. SEC data. Additional models include BloombergGPT [40], FinGPT [42] and Instruct-FinGPT[44].

More advance datasets in the financial domain include FinQA [6], LLMWare [27], ConFIRM [8] and TAT-QA [46] among others [7,38,19] that have been prepared for retrieval and or Questions and Answering (Q&amp;A) tasks over snippets of financial data that includes tabular data, which has allowed methods on large language models to be tested on them [39].

Most of the previous work has focused on understanding the layout of financial documents or understanding specific snippets of existing reports with di ff erent levels of complexity, but there has not been much research in understanding financial report documents, except some more recent work that includes FinanceBench [14], in which a set of questions about the content of financial reports are proposed that includes the evidence snippet.

More specifically on document chunking methods for RAG, there are standard approaches being considered such as chunking text into spans of a given token length (e.g. 128 and 256) or chunking based on sentences. Open source projects already allow simple processing of documents (e.g. Unstructured 4 , Llamaindex 5 or Langchain 6 ), without explicitly considering the table structure on which these chunking strategies are applied.

Even though di ff erent approaches are available, an exhaustive evaluation of chunking applied to RAG and specifically to financial reporting, except for some limited chunking analysis [14,36], is non-existent. In our work, we compare a broad range of chunking approaches in addition to more simple ones and provide an analysis of the outcomes of di ff erent methods when asking questions about di ff erent aspects of the reports.

## 3 Methods

In this section, we present the chunking strategies that we have evaluated. Before describing the chunking strategies, we present the RAG environment in which these strategies have been evaluated and the dataset used for evaluation.

## 3.1 RAG setting for the experiments

The RAG pipeline used to process a user question is presented in figure 1 and is a common instance of a RAG [12]. Prior to answering any question about a given

4 https://unstructured.io

5 https://www.llamaindex.ai

6 https://www.langchain.com

document, the document is split into chunks and the chunks are indexed into a vector database (vectordb). When a question is sent to the RAG system, the top-k chunks most similar to the question are retrieved from the vector database and used to generate the answer using a large language model as generator. In order to retrieve chunks from the vector database, the question is encoded into a vector that is compared to the vector previously generated from the chunks. To prompt the generator, the question is converted into a set of instructions that instruct the LLM to find the answer within the top-k retrieved chunks.

Fig. 1. RAG steps to answer a question about a document

In our experiments, we modify the way documents are chunked prior to being indexed in the vector database. All other settings remain constant. In the following sections, we describe in more detail each one of the components and processes used.

## 3.2 Indexing and retrieval

We have used the open source system Weaviate 7 as our vector database. As encoder model, we have used a sentence transformer [35] trained on over 256M questions and answers, which is available from the HuggingFace system 8 .

As shown in figure 2, to index a document, first the document is split into chunks, then each chunk is processed by an encoder model and then indexed into the vector database. Based on the chunking strategy a document will be split into a larger or smaller set of chunks.

Fig. 2. Indexing of document chunks into the vector database

7 https://weaviate.io/developers/weaviate

8 https://huggingface.co/sentence-transformers/multi-qa-mpnet-base-dotv1

As shown in figure 1, to retrieve chunks relevant to a question, the question is converted into a vector representation and the vector database returns a ranked list of chunks based on the similarity between question vector and the chunks in the database. Weaviate implements an approximate nearest neighbours algorithm [28] as their retrieval approach, which supports fast retrieval with high accuracy. In our experiments, we retrieve the top-10 chunks for each question.

## 3.3 Generation

Once the vector database has retrieved the top-10 chunks based on a question, the generation module generates the answer. To do so, a prompt based on the question and the retrieved chunks are provided to a large language model that generates the answer of the system.

We have used GPT-4 [31] as the generator, which has shown best performance compared to earlier versions. As well, its performance was better compared to existing open source alternatives [22] such as Mixtral [16]. We used the prompt presented in figure 3 that we designed on another similar RAG implementation with di ff erent document types. The prompt conditions the answer to the query and the chunks, referred to as source , and if the generator cannot answer it should return No answer .

```
please answer the question below by referencing the list of sources provided after the question; if the question can not be answered just respond 'No answer'. The sources are listed after ""Sources:"". Question: {query} Sources: {key} - {source} ...
```

Fig. 3. Example prompt template used by the generator

## 3.4 Chunking

As a baseline chunking method, we have split the documents into chunks of size n tokens ( n ∈ ¶ 128 ↪ 256 ↪ 512 ♦ ). As well, an aggregation of the output by the indexing of di ff erent chunking configurations has been considered.

In addition to chunking based on the number of tokens, we have processed the documents using computer vision and natural language processing to extract elements identified in the reports. The list of elements considered are provided by the Unstructured 9 open source library. From the set of processing strategies,

9 https://unstructured-io.github.io/unstructured/introduction.html# elements

we use Chipper, a vision encoder decoder 10 model inspired by Donut [20] to showcase the performance di ff erence. The Chipper model outputs results as a JSON representation of the document, listing elements per page characterized by their element type. Additionally, Chipper provides a bounding box enclosing each element on the page and the corresponding element text.

These elements are sometimes short to be considered as chunks, so to generate chunks from elements the following steps have been followed. Given the structure of finance reporting documents, our structural chunking e ff orts are concentrated on processing titles, texts, and tables. The steps to generate elementbased chunks are:

- -if the element text length is smaller than 2,048 characters, a merge with the following element is attempted
- -iteratively, element texts are merged following the step above till either the desired length is achieved, without breaking the element
- -if a title element is found, a new chunk is started
- -if a table element is found, a new chunk is started, preserving the entire table

After element-based chunks have been derived, three types of metadata are generated to enrich the content and support e ffi cient indexing. The first two types, generated via predefined prompt templates with GPT-4, include: 1) up to 6 representative keywords of the composite chunk 2) a summarised paragraph of the composite chunk. The third type is 3) Naive representation using the first two sentences from a composite chunk (a kind of prefix) and in the case of tables, the description of the table, which is typically identified in the table caption.

## 3.5 Dataset

To evaluate the performance of the di ff erent chunking approaches, we have used the FinanceBench dataset [14]. FinanceBench is a new benchmarking dataset designed to assess the capabilities of LLMs in answering open-book financial questions. The questions collected are realistic and applicable to real-world financial scenarios and include complex questions that require computational reasoning to arrive at conclusive answers.

This dataset is made of 150 instances with questions and answers from 84 unique reports. The dataset does not include the source documents, which we have downloaded. We were able to recover only 80 documents, which reduces the number of questions to 141 from the original 150. The distribution of Unstructured elements predictions are shown in table 1.

Documents have a varying number of pages, spanning from 4 pages (FOOTLOCKER 2022 8K dated-2022-05-20) to 549 pages (e.g. PEPSICO 2021 10K), with an average of 147.34 with std 97.78 with a total of 11,787 pages combined. Each instance contains a link to the report, the question, a question type , the answer and supporting evidence, with page number where the evidence is located

10 https://huggingface.co/docs/transformers/model_doc/vision-encoderdecoder

Table 1. Unstructured element types distribution for Chipper predictions against documents in FinanceBench.

| Element Type      | Chipper Entities   |
|-------------------|--------------------|
| NarrativeText     | 61,780             |
| Title             | 29,664             |
| ListItem          | 33,054             |
| UncategorizedText | 9,400              |
| Footer            | 1,026              |
| Table             | 7,700              |
| Header            | 3,959              |
| Image             | 26                 |
| FigureCaption     | 54                 |
| Formula           | 29                 |
| Address           | 229                |
| Total             | 146,921            |

in the document, that allows for a closer evaluation of the results. Based on the page number, evidence contexts are located in di ff erent areas in the documents, ranging from the first page in some cases up to page 304 in one instance. The mean page number to find the evidence is 54.58 with a standard deviation of 43.66, which shows that evidence contexts to answer the questions are spread within a document. These characteristics make FinanceBench a perfect dataset for evaluating RAG. An example instance is available in table 2.

## 4 Results

In this section, we evaluate the di ff erent chunking strategies using the FinanceBench dataset. Our evaluation is grounded in factual accuracy, which allows us to measure the e ff ectiveness of each configuration by its precision in retrieving answers that match the ground truth, as well as its generation abilities.

We are considering 80 documents and 141 questions from FinanceBench. Using the OpenAI tokenizer from the model text-embedding-ada-002 that uses the tokenizer cl100k base 11 , there are on average 102,444.35 tokens with std of 61,979.45, which shows the large variability of document lengths as seen by the di ff erent number of pages per document presented above.

Chunking E ffi ciency The first thing we analyzed is the total number of chunks, as it impacts indexing time. We would like to observe the relationship between accuracy and total chunk size. Table 3 shows the number of chunks derived from each one of the processing methods. Unstructured element-based chunks are closer in size to Base 512, and as the chunk size decreases for the basic chunking strategies, the total number of chunks increases linearly.

11 https://platform.openai.com/docs/guides/embeddings/limitations-risks

Table 2. Example question from the FinanceBench dataset

| Field                                 | Value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|---------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| financebench id financebench id 00859 | financebench id financebench id 00859                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| doc name                              | VERIZON 2021 10K                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| doc link                              | https://www.verizon.com/about/sites/default/files/2021-Annual- Report-on-Form-10-K.pdf                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| question type                         | 'novel-generated'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| question                              | Among all of the derivative instruments that Verizon used to manage the exposure to fluctuations of foreign currencies exchange rates or interest rates, which one had the highest notional value in FY 2021?                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| answer                                | Cross currency swaps. Its notional value was $ 32,502 million.,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| evidence text                         | Derivative Instruments We enter into derivative transactions primarily to manage our exposure to fluctuations in foreign currency exchange rates and interest rates. We employ risk management strategies, which may include the use of a variety of derivatives including interest rate swaps, cross currency swaps, forward starting interest rate swaps, trea- sury rate locks, interest rate caps, swaptions and foreign exchange for- wards. We do not hold derivatives for trading purposes. The following table sets forth the notional amounts of our outstanding derivative in- struments: (dollars in millions) At December 31, 2021 2020 Interest rate swaps $ 19,779 $ 17,768 Cross currency swaps 32,502 26,288 Forward starting interest rate swaps 1,000 2,000 Foreign exchange forwards 932 1,405 |
| page number                           | 85                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |

Table 3. Chunks statistics for basic chunking elements and Unstructured elements

| Processing total chunks mean chunks per document (std) tables mean (std)   | Processing total chunks mean chunks per document (std) tables mean (std)   | Processing total chunks mean chunks per document (std) tables mean (std)   | Processing total chunks mean chunks per document (std) tables mean (std)   |
|----------------------------------------------------------------------------|----------------------------------------------------------------------------|----------------------------------------------------------------------------|----------------------------------------------------------------------------|
| Base 128                                                                   | 64,058                                                                     | 800.73 (484.11)                                                            | N/A                                                                        |
| Base 256                                                                   | 32,051                                                                     | 400.64 (242.04)                                                            | N/A                                                                        |
| Base 512                                                                   | 16,046                                                                     | 200.58 (121.01)                                                            | N/A                                                                        |
| Chipper                                                                    | 20,843                                                                     | 260.57 (145.80)                                                            | 96.20 (57.53)                                                              |

Retrieval Accuracy Secondly, we evaluate the capabilities of each chunking strategy in terms of retrieval accuracy. We use the page numbers in the ground truth to calculate the page-level retrieval accuracy, and we use ROUGE [24] and BLEU [32] scores to evaluate the accuracy of paragraph-level retrieval compared to the ground truth evidence paragraphs.

As shown in Table 4, when compared to Unstructured element-based chunking strategies, basic chunking strategies seem to have higher page-level retrieval accuracy but lower paragraph-level accuracy on average. Additionally, basic chunking strategies also lack consistency between page-level and paragraph-level accuracy; higher page-level accuracy doesn't ensure higher paragraph-level accuracy. For example, Base 128 has the second highest page-level accuracy but

the lowest paragraph-level scores among all. On the other hand, element-based chunking strategies showed more consistent results.

A fascinating discovery is that when various chunking strategies are combined, it results in enhanced retrieval scores, achieving superior performance at both the page level (84.4%) and paragraph level (with ROUGE at 0.568% and BLEU at 0.452%). This finding addresses an unresolved question: how to improve the accuracy of RAG.

The element based method provides the highest scores and it also provides a mechanism to chunk documents without the need to fine tune hyper-parameters like the number of tokens in a chunk. This suggests the element based method is more generalizable and can be applied to new types of documents.

Q&amp;A Accuracy Third, we evaluate the Q&amp;A accuracy for the chunking strategies. In addition to manual evaluation, we have investigated an automatic evaluation using GPT-4. GPT-4 compares how the answers provided by our method are similar to or di ff erent from the FinanceBench gold standard, similar approaches have been previously evaluated [13,23,29,30]. The automatic evaluation allows scaling the evaluation e ff orts for the di ff erent chunking strategies that we have considered. We used the prompt template in figure 4.

```
Begin with True or False. Are the two following answers (Answer 1 and Answer 2) the same with respect to the question between single quotes '{question}'? Answer 1: '{ground_truth_answer}' Answer 2: '{generated_answer}'
```

Fig. 4. Evaluation prompt template. The ¶ question ♦ , ¶ ground truth answer ♦ and ¶ generated answer ♦ fields are substituted for each question accordingly.

Results in table 5 show that element-based chunking strategies o ff er the best question-answering accuracy, which is consistent with page retrieval and paragraph retrieval accuracy.

Lastly, our approach stands out for its e ffi ciency. Not only is element-based chunking generalizable without the need to select the chunk size, but when compared to the aggregation results that yield the highest retrieval scores. Elementbased chunking achieves the highest retrieval scores with only half the number of chunks required compared to methods that do not consider the structure of the documents (62,529 v.s. 112,155). This can reduce the indexing cost and improve query latency because there are only half as many vectors to index for the vectordb that stores the chunks. This underscores the e ff ectiveness of our solution in optimizing the balance between performance and computational resource requirements.

Table 4. Retrieval results. For each chunking strategy, we show the number of chunks for all the documents (Total Chunks), Page Accuracy, and ROUGE and BLEU scores. ROUGE and BLEU are calculated as the maximum score from the list of recovered contexts for a question when compared to the known evidence for that question.

| Chunking strategy                  | Total Chunks   |   Page Accuracy |   ROUGE |   BLEU |
|------------------------------------|----------------|-----------------|---------|--------|
| Base 128                           | 64,058         |           72.34 |   0.383 |  0.181 |
| Base 256                           | 32,051         |           73.05 |   0.433 |  0.231 |
| Base 512                           | 16,046         |           68.09 |   0.455 |  0.25  |
| Base Aggregation                   | 112,155        |           83.69 |   0.536 |  0.277 |
| Keywords Chipper                   | 20,843         |           46.1  |   0.444 |  0.315 |
| Summary Chipper                    | 20,843         |           62.41 |   0.473 |  0.35  |
| Prefix & Table Description Chipper | 20,843         |           67.38 |   0.514 |  0.4   |
| Chipper Aggregation                | 62,529         |           84.4  |   0.568 |  0.452 |

Table 5. Q&amp;A results. We show the percentage of questions with no answer and as well the accuracy either estimated automatically using GPT-4 or manually.

| Chunking strategy                  |   No answer |   GPT-4 |   Manual |
|------------------------------------|-------------|---------|----------|
| Base 128                           |       35.46 |   29.08 |    35.46 |
| Base 256                           |       25.53 |   32.62 |    36.88 |
| Base 512                           |       24.82 |   41.84 |    48.23 |
| Keywords Chipper                   |       22.7  |   43.97 |    53.19 |
| Summary Chipper                    |       17.73 |   43.97 |    51.77 |
| Prefix & Table Description Chipper |       20.57 |   41.13 |    53.19 |

## 5 Discussion

Results demonstrate the e ffi cacy of our approach in utilizing structural elements for chunking, which has enabled us to attain state-of-the-art performance on Q&amp;A tasks within the FinanceBench dataset (accuracy of 50% vs 53.19%) when an index is created from document chunks and used for generation. This method, which we refer to as element base chunking , has shown to yield consistent results between retrieval and Q&amp;A accuracy.

We have observed that using basic 512 chunking strategies produces results most similar to the Unstructured element-based approach, which may be due to the fact that 512 tokens share a similar length with the token size within our element-based chunks and capture a long context, but fail keep a coherent context in some cases, leaving out relevant information required for Q&amp;A. This is further observed when considering the ROUGE and BLEU scores in table 4, where the chunk contexts for the baseline have lower scores.

These findings support existing research stating that the best basic chunk size varies from data to data [3]. These results show, as well, that our method adapts to di ff erent documents without tuning. Our method relies on the struc-

tural information that is present in the document's layout to adjust the chunk size automatically.

We have evaluated aggregating the output of di ff erent chunking methods in the retrieval experiments as sown in table 4. Even though the aggregation seems to be e ff ective for retrieval, the Q&amp;A exceeded the GPT-4 token limit, which resulted in a non-e ff ective Q&amp;A solution using the selected model.

As well, we evaluated variations of the prompt used to generate the answers (see figure 3). Re-ordering the retrieval context and the question, but results were not statistically di ff erent. We experimented as well with variations of the verbs using in the prompt, e.g. changing referencing with using , which seemed to lower the quality of the answers generated. This shows that prompt engineering is a relevant factor in RAG.

We evaluated using GPT-4 for evaluation instead of relying on manual evaluation. In most cases, GPT-4 evaluated correctly but failed when a more elaborate answer is provided. As shown in figure 5, the answer is 39.7% while the estimated answer is 39.73% but with a detailed explanation of the calculation.

```
Question: 'What is Coca Cola's FY2021 COGS % margin? Calculate what was asked by utilizing the line items clearly shown in the income statement.'? Answer 1: '39.7%' Answer 2: 'From the income statement referenced on page 60 of COCACOLA_2021_10K_embedded.json, we can see that Coca Cola's total revenue in FY2021 was $38,655 million and their cost of goods sold (COGS) was $15,357 million. To calculate the COGS % margin, we divide the COGS by the total revenue and multiply by 100: (15,357 / 38,655) * 100 = 39.73% So, Coca Cola's FY2021 COGS % margin was approximately 39.73%.'
```

Fig. 5. Evaluation prompt template

## 6 Conclusions and Future Work

Results show that our element based chunking strategy improves the state-of-theart Q&amp;A for the task, which is achieved by providing a better chunking strategy for the processed documents. We provide comparison with baseline chunking strategies that allow us to draw conclusions about di ff erent chunking methods.

As future work, we would like to perform a similar evaluation in other domains, e.g. biomedical, to understand how our findings apply outside financial reporting. As well, we would like studying which additional element types and/or relation between elements would support better chunking strategies for RAG.

Furthermore, we would like to study the impact of RAG configuration and element type based chunking.

## References

1. Anantha, R., Bethi, T., Vodianik, D., Chappidi, S.: Context Tuning for Retrieval Augmented Generation (2023)
2. Balaguer, A., Benara, V., de Freitas Cunha, R.L., de M. Estev˜ ao Filho, R., Hendry, T., Holstein, D., Marsman, J., Mecklenburg, N., Malvar, S., Nunes, L.O., Padilha, R., Sharp, M., Silva, B., Sharma, S., Aski, V., Chandra, R.: Rag vs fine-tuning: Pipelines, tradeo ff s, and a case study on agriculture (2024)
3. Barnett, S., Kurniawan, S., Thudumu, S., Brannelly, Z., Abdelrazek, M.: Seven Failure Points When Engineering a Retrieval Augmented Generation System (2024)
4. Bentabet, N.I., Juge, R., El Maarouf, I., Mouilleron, V., Valsamou-Stanislawski, D., El-Haj, M.: The financial document structure extraction shared task (fintoc 2020). In: Proceedings of the 1st Joint Workshop on Financial Narrative Processing and MultiLing Financial Summarisation. pp. 13-22 (2020)
5. Chen, H., Jiao, F., Li, X., Qin, C., Ravaut, M., Zhao, R., Xiong, C., Joty, S.: ChatGPT's One-year Anniversary: Are Open-Source Large Language Models Catching up? arXiv preprint arXiv:2311.16989 (2023)
6. Chen, Z., Chen, W., Smiley, C., Shah, S., Borova, I., Langdon, D., Moussa, R., Beane, M., Huang, T.H., Routledge, B., et al.: Finqa: A dataset of numerical reasoning over financial data. arXiv preprint arXiv:2109.00122 (2021)
7. Chen, Z., Li, S., Smiley, C., Ma, Z., Shah, S., Wang, W.Y.: ConvFinQA: Exploring the Chain of Numerical Reasoning in Conversational Finance Question Answering (2022)
8. Choi, S., Gazeley, W., Wong, S.H., Li, T.: Conversational Financial Information Retrieval Model (ConFIRM). arXiv preprint arXiv:2310.13001 (2023)
9. DeSola, V., Hanna, K., Nonis, P.: Finbert: pre-trained model on sec filings for financial natural language tasks. University of California (2019)
10. El-Haj, M., Rayson, P., Young, S., Walker, M.: Detecting document structure in a very large corpus of UK financial reports. European Language Resources Association (ELRA) (2014)
11. El Maarouf, I., Kang, J., Azzi, A.A., Bellato, S., Gan, M., El-Haj, M.: The financial document structure extraction shared task (FinTOC2021). In: Proceedings of the 3rd Financial Narrative Processing Workshop. pp. 111-119 (2021)
12. Gao, Y., Xiong, Y., Gao, X., Jia, K., Pan, J., Bi, Y., Dai, Y., Sun, J., Wang, H.: Retrieval-augmented generation for large language models: A survey. arXiv preprint arXiv:2312.10997 (2023)
13. Hada, R., Gumma, V., de Wynter, A., Diddee, H., Ahmed, M., Choudhury, M., Bali, K., Sitaram, S.: Are large language model-based evaluators the solution to scaling up multilingual evaluation? arXiv preprint arXiv:2309.07462 (2023)
14. Islam, P., Kannappan, A., Kiela, D., Qian, R., Scherrer, N., Vidgen, B.: FinanceBench: A New Benchmark for Financial Question Answering. arXiv preprint arXiv:2311.11944 (2023)
15. Ji, Z., Lee, N., Frieske, R., Yu, T., Su, D., Xu, Y., Ishii, E., Bang, Y.J., Madotto, A., Fung, P.: Survey of Hallucination in Natural Language Generation. ACM Computing Surveys 55 (12), 1-38 (Mar 2023). https://doi.org/10.1145/3571730, http:// dx.doi.org/10.1145/3571730

16. Jiang, A.Q., Sablayrolles, A., Roux, A., Mensch, A., Savary, B., Bamford, C., Chaplot, D.S., de las Casas, D., Hanna, E.B., Bressand, F., Lengyel, G., Bour, G., Lample, G., Lavaud, L.R., Saulnier, L., Lachaux, M.A., Stock, P., Subramanian, S., Yang, S., Antoniak, S., Scao, T.L., Gervet, T., Lavril, T., Wang, T., Lacroix, T., Sayed, W.E.: Mixtral of Experts (2024)
17. Juge, R., Bentabet, I., Ferradans, S.: The fintoc-2019 shared task: Financial document structure extraction. In: Proceedings of the Second Financial Narrative Processing Workshop (FNP 2019). pp. 51-57 (2019)
18. Kaddour, J., Harris, J., Mozes, M., Bradley, H., Raileanu, R., McHardy, R.: Challenges and applications of large language models. arXiv preprint arXiv:2307.10169 (2023)
19. Kaur, S., Smiley, C., Gupta, A., Sain, J., Wang, D., Siddagangappa, S., Aguda, T., Shah, S.: REFinD: Relation Extraction Financial Dataset. In: Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval. SIGIR '23, ACM (Jul 2023). https://doi.org/10.1145/3539618.3591911, http://dx.doi.org/10.1145/ 3539618.3591911
20. Kim, G., Hong, T., Yim, M., Park, J., Yim, J., Hwang, W., Yun, S., Han, D., Park, S.: Donut: Document understanding transformer without ocr. arXiv preprint arXiv:2111.15664 7 , 15 (2021)
21. Lewis, P., Perez, E., Piktus, A., Petroni, F., Karpukhin, V., Goyal, N., K uttler, H., Lewis, M., Yih, W.t., Rockt aschel, T., et al.: Retrieval-augmented generation for knowledge-intensive NLP tasks. Advances in Neural Information Processing Systems 33 , 9459-9474 (2020)
22. Li, D., Shao, R., Xie, A., Sheng, Y., Zheng, L., Gonzalez, J.E., Stoica, I., Ma, X., Zhang, H.: How Long Can Open-Source LLMs Truly Promise on Context Length? (June 2023), https://lmsys.org/blog/2023-06-29-longchat
23. Li, Y., Duan, Y.: The evaluation of experiments of artificial general intelligence with gpt-4 based on dikwp. arXiv preprint (2023)
24. Lin, C.Y.: Rouge: A package for automatic evaluation of summaries. In: Text summarization branches out. pp. 74-81 (2004)
25. Liu, N.F., Lin, K., Hewitt, J., Paranjape, A., Bevilacqua, M., Petroni, F., Liang, P.: Lost in the middle: How language models use long contexts. arXiv preprint arXiv:2307.03172 (2023)
26. Liu, Z., Huang, D., Huang, K., Li, Z., Zhao, J.: Finbert: A pre-trained financial language representation model for financial text mining. In: Proceedings of the twenty-ninth international conference on international joint conferences on artificial intelligence. pp. 4513-4519 (2021)
27. llmware: Rag Instruct Benchmark Tester. https://huggingface.co/datasets/ llmware/rag_instruct_benchmark_tester , Accessed: January 15, 2024
28. Malkov, Y.A., Yashunin, D.A.: E ffi cient and robust approximate nearest neighbor search using hierarchical navigable small world graphs. IEEE transactions on pattern analysis and machine intelligence 42 (4), 824-836 (2018)
29. Moore, S., Nguyen, H.A., Chen, T., Stamper, J.: Assessing the quality of multiplechoice questions using gpt-4 and rule-based methods. In: European Conference on Technology Enhanced Learning. pp. 229-245. Springer (2023)
30. Naismith, B., Mulcaire, P., Burstein, J.: Automated evaluation of written discourse coherence using gpt-4. In: Proceedings of the 18th Workshop on Innovative Use of NLP for Building Educational Applications (BEA 2023). pp. 394-403 (2023)
31. OpenAI, :, Achiam, J., Adler, S., Agarwal, S., et al.: GPT-4 Technical Report (2023)

32. Papineni, K., Roukos, S., Ward, T., Zhu, W.J.: Bleu: a method for automatic evaluation of machine translation. In: Proceedings of the 40th annual meeting of the Association for Computational Linguistics. pp. 311-318 (2002)
33. Pfitzmann, B., Auer, C., Dolfi, M., Nassar, A.S., Staar, P.: Doclaynet: A large human-annotated dataset for document-layout segmentation. In: Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining. pp. 3743-3751 (2022)
34. Pinecone: Chunking strategies for llm applications, https://www.pinecone.io/ learn/chunking-strategies/
35. Reimers, N., Gurevych, I.: Sentence-bert: Sentence embeddings using siamese bertnetworks. In: Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing. Association for Computational Linguistics (11 2019), https://arxiv.org/abs/1908.10084
36. Retteter, J.: Mastering Table Extraction: Revolutionize Your Earnings Reports Analysis with AI. https://medium.com/unstructured-io/masteringtable-extraction-revolutionize-your-earnings-reports-analysis-withai-1bc32c22720e , Accessed: January 15, 2024
37. Rizinski, M., Peshov, H., Mishev, K., Jovanovik, M., Trajanov, D.: Sentiment Analysis in Finance: From Transformers Back to eXplainable Lexicons (XLex) (2023)
38. Shah, R.S., Chawla, K., Eidnani, D., Shah, A., Du, W., Chava, S., Raman, N., Smiley, C., Chen, J., Yang, D.: WHEN FLUE MEETS FLANG: Benchmarks and Large Pre-trained Language Model for Financial Domain (2022)
39. Singh Phogat, K., Harsha, C., Dasaratha, S., Ramakrishna, S., Akhil Puranam, S.: Zero-Shot Question Answering over Financial Documents using Large Language Models. arXiv e-prints pp. arXiv-2311 (2023)
40. Wu, S., Irsoy, O., Lu, S., Dabravolski, V., Dredze, M., Gehrmann, S., Kambadur, P., Rosenberg, D., Mann, G.: BloombergGPT: A Large Language Model for Finance (2023)
41. Xu, P., Ping, W., Wu, X., McAfee, L., Zhu, C., Liu, Z., Subramanian, S., Bakhturina, E., Shoeybi, M., Catanzaro, B.: Retrieval meets Long Context Large Language Models (2023)
42. Yang, H., Liu, X.Y., Wang, C.D.: FinGPT: Open-Source Financial Large Language Models (2023)
43. Ye, H., Liu, T., Zhang, A., Hua, W., Jia, W.: Cognitive Mirage: A Review of Hallucinations in Large Language Models (2023)
44. Zhang, B., Yang, H., Liu, X.Y.: Instruct-FinGPT: Financial Sentiment Analysis by Instruction Tuning of General-Purpose Large Language Models (2023)
45. Zheng, X., Burdick, D., Popa, L., Zhong, X., Wang, N.X.R.: Global table extractor (gte): A framework for joint table identification and cell structure recognition using visual context. In: Proceedings of the IEEE/CVF winter conference on applications of computer vision. pp. 697-706 (2021)
46. Zhu, F., Lei, W., Huang, Y., Wang, C., Zhang, S., Lv, J., Feng, F., Chua, T.S.: TAT-QA: A question answering benchmark on a hybrid of tabular and textual content in finance. arXiv preprint arXiv:2105.07624 (2021)","[{'page_size': {'width': 612.0, 'height': 792.0}, 'image': None, 'page_no': 1}, {'page_size': {'width': 612.0, 'height': 792.0}, 'image': None, 'page_no': 2}, {'page_size': {'width': 612.0, 'height': 792.0}, 'image': None, 'page_no': 3}, {'page_size': {'width': 612.0, 'height': 792.0}, 'image': None, 'page_no': 4}, {'page_size': {'width': 612.0, 'height': 792.0}, 'image': None, 'page_no': 5}, {'page_size': {'width': 612.0, 'height': 792.0}, 'image': None, 'page_no': 6}, {'page_size': {'width': 612.0, 'height': 792.0}, 'image': None, 'page_no': 7}, {'page_size': {'width': 612.0, 'height': 792.0}, 'image': None, 'page_no': 8}, {'page_size': {'width': 612.0, 'height': 792.0}, 'image': None, 'page_no': 9}, {'page_size': {'width': 612.0, 'height': 792.0}, 'image': None, 'page_no': 10}, {'page_size': {'width': 612.0, 'height': 792.0}, 'image': None, 'page_no': 11}, {'page_size': {'width': 612.0, 'height': 792.0}, 'image': None, 'page_no': 12}, {'page_size': {'width': 612.0, 'height': 792.0}, 'image': None, 'page_no': 13}, {'page_size': {'width': 612.0, 'height': 792.0}, 'image': None, 'page_no': 14}, {'page_size': {'width': 612.0, 'height': 792.0}, 'image': None, 'page_no': 15}]",docling,"{'source': 'docling parser', 'note': 'Content extracted from PDF, metadata comes from arXiv API'}"
